import{c as O,r as z,a as N,p as P,u as $,j as e,P as U,G as p,T as V,F as L,I as T,S as k,M as f,b as u,d as W,e as G,B as x,f as h,Q as K,g as F,C as _,h as Q,i as q,k as Z,l as j,m as J,L as S,n as R,o as X,q as B,s as Y,t as ee,A as te,v as re,w as se,x as ne,y as oe,z as ie,R as ae,D as A,E as ce,H as le}from"./vendor-B2aoq6yM.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function i(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=i(s);fetch(s.href,n)}})();const E=O({palette:{mode:"dark",primary:{main:"#20A79A",background:"#FFFFFF"},secondary:{main:"#FFFFFF",background:"#17786E"},background:{main:"#424242"},error:{main:z.A400}}}),M=O({palette:{mode:"light",primary:{main:"#12645B",background:"#FFFFFF"},secondary:{main:"#000000",background:"#22B9AA"},background:{main:"#17786E"},error:{main:z.A400}}}),de="/dokimotes/assets/emojis-zRPJtRgx.tsv";var y=(t=>(t.ALL="all",t.ANIMATED="animated",t.STILL="still",t))(y||{}),v=(t=>(t.ALL="all",t.OFFICIAL="official",t.FANMADE="fan-made",t))(v||{});const he=t=>{const r=t.trim().split(`
`),i=r.shift().split("	").map(s=>s.trim());return r.map(s=>{const n=s.split("	");return i.reduce((o,m,l)=>{const c=n[l]===""?"Unknown":n[l];return m==="tags"?o[m]=c.split(",").map(d=>d.trim()):o[m]=c,o},{})})},me=async()=>{try{const r=await(await fetch(de)).text();return he(r)}catch{return}},ue=t=>({theme:"system",density:"standard",timeFormat:"relative",transcriptHeight:"100%",enableTagHelper:!1,defaultOffset:-20,sidebarOpen:!0,devMode:!1,membershipKey:"",membershipInfo:null,useVirtualList:!1,setTheme:r=>t({theme:r}),setDensity:r=>t({density:r}),setTimeFormat:r=>t({timeFormat:r}),setTranscriptHeight:r=>t({transcriptHeight:r}),setEnableTagHelper:r=>t({enableTagHelper:r}),setDefaultOffset:r=>t({defaultOffset:r}),setSidebarOpen:r=>t({sidebarOpen:r}),setDevMode:r=>t({devMode:r}),setMembershipKey:r=>t({membershipKey:r}),setMembershipInfo:r=>t({membershipInfo:r}),setUseVirtualList:r=>t({useVirtualList:r})}),pe=t=>({searchText:"",setSearchText:r=>t({searchText:r}),emojiType:y.ALL,setEmojiType:r=>t({emojiType:r}),emojiSource:v.ALL,setEmojiSource:r=>t({emojiSource:r}),scrollIndex:0,setScrollIndex:r=>t({scrollIndex:r})}),b=N()(P((t,r,i)=>({...pe(t),...ue(t)}),{name:"live-transcript-settings",partialize:t=>({theme:t.theme,density:t.density,timeFormat:t.timeFormat,transcriptHeight:t.transcriptHeight,enableTagHelper:t.enableTagHelper,defaultOffset:t.defaultOffset,sidebarOpen:t.sidebarOpen,devMode:t.devMode,membershipKey:t.membershipKey,membershipInfo:t.membershipInfo,useVirtualList:t.useVirtualList})})),xe=()=>{const{searchText:t,emojiType:r,emojiSource:i}=b($(o=>({searchText:o.searchText,emojiType:o.emojiType,emojiSource:o.emojiSource}))),a=b(o=>o.setSearchText),s=b(o=>o.setEmojiType),n=b(o=>o.setEmojiSource);return e.jsx(U,{elevation:2,sx:{p:2,mb:2,borderRadius:2},children:e.jsxs(p,{container:!0,spacing:2,alignItems:"center",justifyContent:"center",children:[e.jsx(p,{size:{xs:12,md:6},children:e.jsx(V,{fullWidth:!0,label:"Search",variant:"outlined",value:t,onChange:o=>a(o.target.value),size:"small"})}),e.jsx(p,{size:{xs:6,md:3},children:e.jsxs(L,{fullWidth:!0,variant:"outlined",size:"small",children:[e.jsx(T,{id:"type-filter-label",children:"Type"}),e.jsxs(k,{labelId:"type-filter-label",id:"type-filter",value:r,label:"Type",name:"type",onChange:o=>s(o.target.value),children:[e.jsx(f,{value:y.ALL,children:"All Types"}),e.jsx(f,{value:y.ANIMATED,children:"Animated"}),e.jsx(f,{value:y.STILL,children:"Still"})]})]})}),e.jsx(p,{size:{xs:6,md:3},children:e.jsxs(L,{fullWidth:!0,variant:"outlined",size:"small",children:[e.jsx(T,{id:"source-filter-label",children:"Source"}),e.jsxs(k,{labelId:"source-filter-label",id:"source-filter",value:i,label:"Source",name:"source",onChange:o=>n(o.target.value),children:[e.jsx(f,{value:v.ALL,children:"All Sources"}),e.jsx(f,{value:v.OFFICIAL,children:"Official"}),e.jsx(f,{value:v.FANMADE,children:"Fan-made"})]})]})})]})})},D=128,ge=({emoji:t})=>{const r=W();if(!t)return null;const i=()=>{r(`/view/${t.source}/${t.id.split(".")[0]}`)};return e.jsx(G,{arrow:!0,title:e.jsxs(e.Fragment,{children:[e.jsx(h,{color:"inherit",variant:"subtitle2",children:t.name}),e.jsxs(h,{variant:"caption",children:["Artist: ",t.artist]}),e.jsx("br",{})]}),children:e.jsx(x,{onClick:i,sx:{width:D,height:D,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",cursor:"pointer",padding:"4px","&:hover":{backgroundColor:"action.hover",transform:"scale(1.1)",zIndex:1},transition:"transform 0.1s ease-in-out, background-color 0.1s ease-in-out"},children:e.jsx("img",{src:`/dokimotes/emotes/${t.source}/${t.id}`,alt:t.name,loading:"lazy",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})})},fe=u.memo(ge),I=16,H=128,je=t=>e.jsx(x,{...t,sx:{display:"grid",gridTemplateColumns:`repeat(auto-fill, minmax(${H+I}px, 1fr))`,gap:`${I/2}px`,padding:`${I/2}px`}}),be=t=>e.jsx(x,{...t,sx:{display:"flex",justifyContent:"center",alignItems:"center",height:`${H+I}px`}}),ye=({emojis:t})=>e.jsx(x,{sx:{width:"100%",height:"100%"},children:e.jsx(K,{data:t,components:{List:je,Item:be},itemContent:(r,i)=>e.jsx(fe,{emoji:i})})}),ve=(t,r,i,a)=>t.filter(s=>{const n=s.name.toLowerCase().includes(r.toLowerCase()),o=s.tags.some(d=>d!==""&&(d.toLowerCase().includes(r.toLowerCase())||r.toLowerCase().includes(d.toLowerCase()))),m=r===""||n||o,l=i===y.ALL||s.type===i,c=a===v.ALL||s.source===a;return m&&l&&c}),we=({emojis:t,emptyText:r})=>{const i=F("(max-width:768px)"),a=F("(max-width:1229px)"),s=i?"100vw":a?"75vw":"50vw",{searchText:n,emojiType:o,emojiSource:m}=b($(c=>({searchText:c.searchText,emojiType:c.emojiType,emojiSource:c.emojiSource}))),l=u.useMemo(()=>ve(t,n,o,m),[n,o,m,t]);return e.jsxs(p,{container:!0,direction:"column",minWidth:s,sx:{py:3,height:"100vh"},children:[e.jsx(p,{size:{xs:12},children:e.jsx(h,{variant:"h4",component:"h4",gutterBottom:!0,align:"center",sx:{mb:3},children:"Doki Emote Finder"})}),e.jsx(p,{size:{xs:12},children:e.jsx(xe,{})}),e.jsx(p,{size:{xs:12},sx:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:0},children:e.jsx(x,{sx:{flexGrow:1,border:"1px solid",borderColor:"divider",borderRadius:1,overflow:"hidden",position:"relative"},children:l.length>0?e.jsx(ye,{emojis:l}):e.jsx(x,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(h,{children:r})})})}),e.jsx(p,{size:{xs:12},sx:{pt:2},children:e.jsxs(h,{variant:"caption",align:"center",sx:{mt:2},children:["Showing ",l.length," of ",t.length," emojis."]})})]})},Ie=({emoji:t})=>{const i=F("(max-width:768px)")?"90vw":"600px",[a,s]=u.useState({open:!1,message:""}),n=`/dokimotes/emotes/${t.source}/${t.id}`,o=`${t.name}-${t.id}`,m=t.credit.startsWith("https://"),l=t.id.endsWith(".gif"),c=async()=>{try{const C=await(await fetch(n)).blob();await navigator.clipboard.write([new ClipboardItem({[C.type]:C})]),s({open:!0,message:"Image copied to clipboard!"})}catch(g){s({open:!0,message:`Error: Could not copy image: ${g}.`})}},d=async()=>{try{const g=`${window.location.origin}${n}`;await navigator.clipboard.writeText(g),s({open:!0,message:"Image link copied to clipboard!"})}catch(g){s({open:!0,message:`Error: Could not copy image link: ${g}.`})}},w=()=>{s({...a,open:!1})};return e.jsxs(e.Fragment,{children:[e.jsxs(_,{sx:{maxWidth:i,margin:{xs:"1rem auto",sm:"2rem auto"},boxShadow:3,width:"100%"},children:[e.jsx(Q,{component:"img",image:n,alt:t.name,sx:{width:"100%",height:"auto",backgroundColor:"transparent"}}),e.jsxs(q,{sx:{textAlign:"center"},children:[e.jsx(h,{gutterBottom:!0,variant:"h4",component:"h1",children:t.name}),e.jsxs(h,{variant:"body1",color:"text.secondary",component:"p",children:[e.jsx("strong",{children:"Artist:"})," ",t.artist]}),m?e.jsxs(h,{variant:"body1",color:"text.secondary",component:"p",children:[e.jsx("strong",{children:"Credits:"})," ",e.jsx("a",{href:t.credit,target:"_blank",style:{wordWrap:"break-word"},children:t.credit})]}):e.jsxs(h,{variant:"body1",color:"text.secondary",component:"p",children:[e.jsx("strong",{children:"Credits:"})," ",t.credit]}),e.jsxs(h,{variant:"body1",color:"text.secondary",component:"p",children:[e.jsx("strong",{children:"Tags:"})," ",t.tags.join(", ")]})]}),e.jsx(Z,{sx:{justifyContent:"center",paddingBottom:"16px"},children:e.jsxs(x,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",sm:"row"},width:"100%"},children:[!l&&e.jsx(j,{variant:"contained",disabled:l,startIcon:e.jsx(J,{}),onClick:c,fullWidth:!0,children:"Copy Image"}),e.jsx(j,{variant:"contained",startIcon:e.jsx(S,{}),onClick:d,fullWidth:!0,children:"Copy Link"}),e.jsx(j,{variant:"outlined",startIcon:e.jsx(S,{}),fullWidth:!0,component:"a",href:n,download:o,children:"Download Image"}),e.jsx(j,{component:R,to:"/",variant:"contained",startIcon:e.jsx(X,{}),color:"black",fullWidth:!0,children:"Back to Gallery"})]})})]}),e.jsx(B,{open:a.open,autoHideDuration:3e3,onClose:w,message:a.message,anchorOrigin:{vertical:"bottom",horizontal:"center"}})]})},Fe=({id:t,source:r})=>e.jsxs(e.Fragment,{children:[e.jsx(ee,{sx:{fontSize:80,color:"text.secondary",marginBottom:2}}),e.jsx(h,{variant:"h4",component:"h1",gutterBottom:!0,children:"Dokimote Not Found"}),e.jsxs(h,{color:"text.secondary",sx:{maxWidth:400,mb:3},children:['That emote with ID "',t,'" and source "',r,'" does not seem to exist. It might have been removed or the link is incorrect.']}),e.jsx(j,{component:R,to:"/",variant:"contained",color:"secondary",children:"Back to Gallery"})]}),Ce=({emojis:t,status:r})=>{const{source:i,id:a}=Y(),s=t.find(n=>n.id.includes(a)&&n.source===i);return e.jsx(x,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:r==="loading"?e.jsx(h,{children:"Loading"}):e.jsx(e.Fragment,{children:s===void 0?e.jsx(Fe,{id:a,source:i}):e.jsx(Ie,{emoji:s})})})},Le=(t=300*1e3)=>{const[r,i]=u.useState(!1),a=async()=>{try{const s=await fetch("/dokimotes/version.json",{cache:"no-store"});if(!s.ok)return;const n=await s.json();n.buildTime>1768363977840&&(console.log("Update available!",n.buildTime,1768363977840),i(!0))}catch(s){console.error("Failed to check for updates:",s)}};return u.useEffect(()=>{a();const s=setInterval(a,t);return()=>clearInterval(s)},[t]),{updateAvailable:r}},Te=()=>{const{updateAvailable:t}=Le(),r=W(),[i,a]=u.useState(!1),s=()=>{a(!0),r("/",{replace:!0}),setTimeout(()=>{window.location.reload(!0)},100)};return e.jsx(B,{open:t,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{width:"90%",maxWidth:500,top:{xs:"12px !important",sm:"24px !important"},left:"50% !important",transform:"translateX(-50%) !important"},children:e.jsxs(te,{severity:"info",variant:"filled",icon:!1,sx:{alignItems:"center",width:"100%",backgroundColor:"#17786E",backdropFilter:"blur(8px)",color:"#FFFFFF",fontWeight:500,boxShadow:"0 4px 20px rgba(0,0,0,0.4)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.2)"},action:e.jsx(j,{variant:"contained",size:"small",disabled:i,startIcon:i?e.jsx(se,{size:20,color:"inherit"}):e.jsx(ne,{}),onClick:s,sx:{backgroundColor:"#FFFFFF",color:"black",borderRadius:"8px",textTransform:"none",fontWeight:"bold",px:2,whiteSpace:"nowrap",boxShadow:"0 2px 10px rgba(0,0,0,0.3)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"0 4px 12px rgba(0,0,0,0.4)"}},children:i?"Updating...":"Update"}),children:[e.jsx(re,{children:"Update Available"}),"Refresh the page or click the update button to update the website."]})})},ke=()=>{const t=b(c=>c.theme);let i=F("(prefers-color-scheme: dark)")?E:M;t==="light"?i=M:t==="dark"&&(i=E);const[a,s]=u.useState([]),[n,o]=u.useState("loading"),m=n==="loading"?"Loading":n==="error"?"Error loading emoji's":"No emoji's found matching your criteria.",l=c=>{for(let d=c.length-1;d>0;d--){const w=Math.floor(Math.random()*(d+1));[c[d],c[w]]=[c[w],c[d]]}return c};return u.useEffect(()=>{me().then(c=>{if(c===void 0){o("error");return}else s(l(c)),o("ok")})},[]),e.jsxs(oe,{theme:i,children:[e.jsx(ie,{}),e.jsx(Te,{}),e.jsxs(ae,{children:[e.jsx(A,{path:"/view/:source/:id",element:e.jsx(Ce,{emojis:a,status:n})}),e.jsx(A,{path:"*",element:e.jsx(we,{emojis:a,emptyText:m})})]})]})};ce.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(le,{basename:"dokimotes",children:e.jsx(ke,{})})}));
