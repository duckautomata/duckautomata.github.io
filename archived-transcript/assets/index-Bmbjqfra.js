import{c as Ke,r as ze,o as He,a as ot,p as lt,u as ce,b as P,d,j as e,C as pe,B as m,T as l,G as L,F as Ce,e as De,f as Ae,M as _e,g as $e,A as Ue,S as Ve,h as G,i as D,E as ct,D as ae,k as ie,l as oe,m as Y,n as X,q as J,s as Q,t as le,P as Pe,v as me,I as xe,w as ue,x as $,y as Ie,z as dt,H as ht,J as fe,L as _,K as Be,N as mt,O as xt,Q as U,R as Z,U as O,V,W as ut,X as pt,Y as ft,Z as gt,_ as ge,$ as Ne,a0 as We,a1 as qe,a2 as jt,a3 as yt,a4 as bt,a5 as ne,a6 as vt,a7 as wt,a8 as St,a9 as Tt,aa as Ye,ab as Xe,ac as Fe,ad as R,ae as Je,af as Qe,ag as se,ah as Ze,ai as kt,aj as et,ak as Ct,al as Dt,am as It,an as Wt,ao as Ft,ap as Et,aq as Lt,ar as Mt,as as Oe,at as ee,au as At,av as $t}from"./vendor-DjrP313b.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Ge=Ke({palette:{mode:"dark",id:{main:"#20A79A",clip:He[900],background:"#FFFFFF"},timestamp:{main:"#8093E0"},lineground:{main:"#395553",clip:"#39254D"},primary:{main:"#20A79A",alt:"#71e2d7ff",background:"#FFFFFF"},secondary:{main:"#FFFFFF",background:"#17786E"},background:{main:"#424242",paper:"#202020"},error:{main:ze.A400}}}),Re=Ke({palette:{mode:"light",id:{main:"#12645B",clip:He[900],background:"#22B9AA"},timestamp:{main:"#304BC5"},lineground:{main:"#89A5A3",clip:"#C5B4E3"},primary:{main:"#12645B",alt:"#0a3b36",background:"#FFFFFF"},secondary:{main:"#000000",background:"#22B9AA"},background:{main:"#17786E",paper:"#f5f5f5"},error:{main:ze.A400}}}),Bt=t=>({searchText:"",setSearchText:r=>t({searchText:r}),streamer:"",setStreamer:r=>t({streamer:r}),streamType:[],setStreamType:r=>t({streamType:r}),fromDate:"",setFromDate:r=>t({fromDate:r}),toDate:"",setToDate:r=>t({toDate:r}),streamTitle:"",setStreamTitle:r=>t({streamTitle:r}),matchWholeWord:!1,setMatchWholeWord:r=>t({matchWholeWord:r})}),Ot=t=>({theme:"system",density:"standard",timeFormat:"relative",transcriptHeight:"100%",enableTagHelper:!1,defaultOffset:-20,sidebarOpen:!0,devMode:!1,membershipKey:"",membershipInfo:null,useVirtualList:!1,setTheme:r=>t({theme:r}),setDensity:r=>t({density:r}),setTimeFormat:r=>t({timeFormat:r}),setTranscriptHeight:r=>t({transcriptHeight:r}),setEnableTagHelper:r=>t({enableTagHelper:r}),setDefaultOffset:r=>t({defaultOffset:r}),setSidebarOpen:r=>t({sidebarOpen:r}),setDevMode:r=>t({devMode:r}),setMembershipKey:r=>t({membershipKey:r}),setMembershipInfo:r=>t({membershipInfo:r}),setUseVirtualList:r=>t({useVirtualList:r})}),v=ot()(lt((t,r,n)=>({...Bt(t),...Ot(t)}),{name:"live-transcript-settings",partialize:t=>({theme:t.theme,density:t.density,timeFormat:t.timeFormat,transcriptHeight:t.transcriptHeight,enableTagHelper:t.enableTagHelper,defaultOffset:t.defaultOffset,sidebarOpen:t.sidebarOpen,devMode:t.devMode,membershipKey:t.membershipKey,membershipInfo:t.membershipInfo,useVirtualList:t.useVirtualList})}));function Gt(){const t=ce(),r=P("(max-width:599px)"),[n,c]=d.useState(""),[s,o]=d.useState(""),h=()=>{n.trim()&&t(`/transcript/${n.trim()}`)},p=()=>{s.trim()&&t(`/graph/${s.trim()}`)},u=i=>{i.key==="Enter"&&h()},w=i=>{i.key==="Enter"&&p()};return e.jsxs(pe,{maxWidth:"lg",sx:{minHeight:"80vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",py:4},children:[e.jsxs(m,{sx:{mb:6,textAlign:"center"},children:[e.jsx(l,{variant:r?"h3":"h2",component:"h1",color:"primary",fontWeight:"bold",sx:{background:i=>`linear-gradient(45deg, ${i.palette.primary.main}, ${i.palette.primary.alt})`,backgroundClip:"text",textFillColor:"transparent",mb:2},children:"Archived Transcripts"}),e.jsx(l,{variant:"h6",color:"text.secondary",sx:{maxWidth:600,mx:"auto"},children:"Search past streams or view specific transcripts."})]}),e.jsxs(L,{container:!0,spacing:4,justifyContent:"center",alignItems:"stretch",sx:{mb:6,maxWidth:800},children:[e.jsx(L,{item:!0,xs:12,sm:6,sx:{display:"flex"},children:e.jsx(Ce,{in:!0,timeout:500,children:e.jsx(De,{sx:{width:"100%",borderRadius:4,transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out","&:hover":{transform:"translateY(-8px)",boxShadow:i=>i.shadows[10]}},elevation:4,children:e.jsxs(Ae,{onClick:()=>t("/search"),sx:{height:"100%",p:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(m,{sx:{mb:2,p:2,borderRadius:"50%",bgcolor:"primary.light",color:"primary.contrastText",display:"flex"},children:e.jsx(_e,{fontSize:"large",sx:{fontSize:40}})}),e.jsxs($e,{sx:{p:0,textAlign:"center"},children:[e.jsx(l,{gutterBottom:!0,variant:"h5",component:"div",fontWeight:"medium",children:"Search"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"Search through all archived transcripts."})]})]})})})}),e.jsx(L,{item:!0,xs:12,sm:6,sx:{display:"flex"},children:e.jsx(Ce,{in:!0,timeout:700,children:e.jsx(De,{sx:{width:"100%",borderRadius:4,transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out","&:hover":{transform:"translateY(-8px)",boxShadow:i=>i.shadows[10]}},elevation:4,children:e.jsxs(Ae,{onClick:()=>t("/graph"),sx:{height:"100%",p:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(m,{sx:{mb:2,p:2,borderRadius:"50%",bgcolor:"secondary.light",color:"secondary.contrastText",display:"flex"},children:e.jsx(Ue,{fontSize:"large",sx:{fontSize:40}})}),e.jsxs($e,{sx:{p:0,textAlign:"center"},children:[e.jsx(l,{gutterBottom:!0,variant:"h5",component:"div",fontWeight:"medium",children:"Graph"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"View word count graphs for streams."})]})]})})})})]}),e.jsx(Ce,{in:!0,timeout:900,children:e.jsx(De,{sx:{p:4,borderRadius:4,maxWidth:600,width:"100%"},elevation:2,children:e.jsxs(Ve,{spacing:3,children:[e.jsx(l,{variant:"h6",fontWeight:"medium",align:"center",gutterBottom:!0,children:"Direct Access"}),e.jsxs(m,{sx:{display:"flex",gap:1,flexDirection:r?"column":"row"},children:[e.jsx(G,{fullWidth:!0,label:"View Transcript by ID",variant:"outlined",value:n,onChange:i=>c(i.target.value),onKeyDown:u,size:"small"}),e.jsx(D,{variant:"contained",onClick:h,disabled:!n.trim(),sx:{minWidth:80},children:"View"})]}),e.jsxs(m,{sx:{display:"flex",gap:1,flexDirection:r?"column":"row"},children:[e.jsx(G,{fullWidth:!0,label:"Graph Stream by ID",variant:"outlined",value:s,onChange:i=>o(i.target.value),onKeyDown:w,size:"small"}),e.jsx(D,{variant:"contained",color:"secondary",onClick:p,disabled:!s.trim(),sx:{minWidth:80},children:"Graph"})]})]})})}),e.jsxs(m,{sx:{mt:6,textAlign:"center"},children:[e.jsx(l,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:"Looking for active streams?"}),e.jsx(D,{href:"/live-transcript",variant:"outlined",size:"large",sx:{mt:1,borderRadius:2,px:4,textTransform:"none"},children:"Go to Live-Transcript"})]})]})}function Rt(){return e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",height:"50vh"},children:[e.jsx(ct,{color:"error",sx:{fontSize:60,mb:2}}),e.jsx(l,{variant:"h5",component:"h2",sx:{mb:1},children:"Archived Transcript is currently down for maintenance."}),e.jsx(l,{color:"text.secondary",children:window.maintenanceText1}),e.jsx(l,{color:"text.secondary",children:window.maintenanceText2})]})}const Kt="/archived-transcript/assets/membership-setting-empty-light-BLpuD1rC.png",zt="/archived-transcript/assets/membership-setting-set-light-BFpSlQrQ.png",Ht="/archived-transcript/assets/membership-example-stream-light-Cvt2m45H.png",_t="/archived-transcript/assets/search-empty-light-ae3s9cTI.png",Ut="/archived-transcript/assets/search-notext-light-DtWOKsXX.png",Vt="/archived-transcript/assets/search-text-light-B-aNugVU.png",Pt="/archived-transcript/assets/membership-setting-empty-dark-B_xuXG27.png",Nt="/archived-transcript/assets/membership-setting-set-dark-U7bfrawS.png",qt="/archived-transcript/assets/membership-example-stream-dark-DXvwav2E.png",Yt="/archived-transcript/assets/search-empty-dark-BSedxSU1.png",Xt="/archived-transcript/assets/search-notext-dark-mm0QIbfN.png",Jt="/archived-transcript/assets/search-text-dark-4wMiq-z3.png",te=({src:t,width:r="100%",alt:n=""})=>e.jsx(Pe,{elevation:3,sx:{my:2,p:.5,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider",borderRadius:1,width:"fit-content",maxWidth:"100%",mx:"auto",overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:t,alt:n,style:{width:r,maxWidth:"100%",height:"auto",display:"block",margin:"0 auto"}})});function Qt({open:t,setOpen:r}){const n=v(p=>p.theme),c=P("(prefers-color-scheme: dark)"),s=n==="dark"||n==="system"&&c,o={membershipSettingEmpty:s?Pt:Kt,membershipSettingSet:s?Nt:zt,membershipExampleStream:s?qt:Ht,searchEmpty:s?Yt:_t,searchNoText:s?Xt:Ut,searchText:s?Jt:Vt},h=()=>{r(!1)};return e.jsx("div",{children:e.jsxs(ae,{open:t,onClose:h,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ie,{id:"alert-dialog-title",children:"How to Use Archived Transcript"}),e.jsx(oe,{children:e.jsxs("div",{children:[e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Settings"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Settings are at the left of the page. Click the cogwheel icon to view the settings menu."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"There are currently 3 settings. All settings are stored in local storage and persist across sessions."}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Theme: Select the color theme of the site. Light, Dark, or System default.",e.jsx("blockquote",{children:"System default will use whatever you set in your operating system. This is set by default."})]}),e.jsxs("li",{children:["Density: How much space should be between lines.",e.jsx("blockquote",{children:"Select whichever makes it easier to read."})]})]}),'The third setting is explained in the "Membership" section.']})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Sidebar"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Allows you to easily jump between pages. Located on the left of your screen."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Sidebar is broken up into 2 parts."}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Pages",e.jsx("blockquote",{children:"Select how you want to query the transcripts. Either search them, or graph them."})]}),e.jsxs("li",{children:["Other",e.jsx("blockquote",{children:"General options. View github url, open the help menu (this), or change the site settings."})]})]})]})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Search"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:"You can search for when something was said and in what stream it was said in. You can also use filters to refine your search."}),e.jsx(te,{src:o.searchEmpty,alt:"Empty Search"}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:'Match Whole Word means it will not include any substrings of your search text. For example: say you search for "ball". If Match Whole Word is enabled, then it will only return results for "ball" and not "balls" or "baller".'}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"If search text is empty, then it will try to find all streams that match the filter, but return no text."}),e.jsx(te,{src:o.searchNoText,alt:"No Text Search"}),e.jsx("br",{}),e.jsxs(l,{variant:"body1",gutterBottom:!0,children:["Once the search has been completed, you will see a list of streams that fit the criteria. You can click on a stream to:",e.jsxs("ul",{children:[e.jsx("li",{children:"view contexts of your search text"}),e.jsx("li",{children:"Click a button to view the entire transcript for that stream"}),e.jsx("li",{children:"Click a button to graph that stream only"})]})]}),e.jsx(te,{src:o.searchText,alt:"Text Search"}),e.jsxs(l,{variant:"body1",gutterBottom:!0,children:["You can also click on the link button on a context line to:",e.jsxs("ul",{children:[e.jsx("li",{children:"Jump to the transcript at that timestamp"}),e.jsx("li",{children:"Copy the link to the stream at that timestamp"}),e.jsx("li",{children:"Open the stream at that timestamp in a new tab"})]})]})]})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Graph"})}),e.jsxs(Q,{children:[e.jsxs(l,{variant:"body1",gutterBottom:!0,children:["You can graph word or phase usage over time. There are two types of graph:",e.jsxs("ul",{children:[e.jsx("li",{children:"Across multiple streams"}),e.jsx("li",{children:"Across a single stream"})]})]}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:'The multi-stream graph can be accessed by clicking the graph button in the sidebar. The single-stream graph can only be accessed by clicking the "Graph This Stream" button on the search page.'}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Graphing functions the same as searching, with the only difference being you view a graph instead of a list of streams."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Once graphed, you can switch between a cumulative sum or a rate over time (default)."})]})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Transcript"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:'You can view the entire transcript for a stream by clicking the "View Full Transcript" button on the search page.'}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"The transcript view is the exact same as on Live-Transcript. You can click the link button on the left of a line to either open the stream at that timestamp or copy the link to it."})]})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Membership"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:"In order to search through members transcripts, you must have a valid key. Each streamer has their own key, and you can only use one key at a time. This means that you cannot search through members streams of multiple streamers at the same time."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"To verify your key, go to settings"}),e.jsx(te,{src:o.membershipSettingEmpty,alt:"Empty Membership Setting"}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Enter the key, and click verify. If valid, it will be saved and you will see what streamer it is valid for, and when it expires."}),e.jsx(te,{src:o.membershipSettingSet,alt:"Membership Setting Set Successfully"}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"You can set a new key by deleting the key and verifying a new one."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Once the key is verified, you will be able to search through and graph members streams."}),e.jsx(te,{src:o.membershipExampleStream,alt:"Example Membership Stream"})]})]})]})}),e.jsx(le,{children:e.jsx(D,{onClick:h,children:"Close"})})]})})}const tt="https://archive.duck-automata.com",Zt=20;async function de(t,r={}){const n={Accept:"application/json",...r.headers},c=v.getState().membershipKey;c&&(n["X-Membership-Key"]=c);const s=await fetch(`${tt}${t}`,{...r,method:"GET",headers:n});if(!s.ok){const o=`HTTP error ${s.status}: ${s.statusText}`,h=s.status;let p="";try{p=(await s.json()).error||o}catch{p=o}const u=new Error(p);throw u.status=h,u}return s.status===204?null:await s.json()}function Ee(t){if(!t)return"";const r=new URLSearchParams;Object.entries(t).forEach(([c,s])=>{s!=null&&(Array.isArray(s)?s.forEach(o=>r.append(c,o)):r.append(c,s.toString()))});const n=r.toString();return n?`?${n}`:""}async function er(t){if(!t)throw new Error("Transcript ID is required");return de(`/transcript/${t}`)}async function tr(t){const r=Ee(t);return de(`/transcripts${r}`)}async function rr(t,r={}){if(!t)throw new Error("Graph ID is required");const n={searchText:r.searchText,matchWholeWord:r.matchWholeWord},c=Ee(n);return de(`/graph/${t}${c}`)}async function sr(t){const r=Ee(t);return de(`/graph${r}`)}async function nr(t){return de(`/stream/${t}`)}async function ar(t){const r=await fetch(`${tt}/membership/verify`,{method:"GET",headers:{Accept:"application/json","X-Membership-Key":t}});if(!r.ok)throw r.status===401?new Error("Invalid membership key"):new Error(`Verification failed: ${r.statusText}`);return await r.json()}const rt=t=>{if(t==="")return;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return null;const[r,n,c]=t.split("-").map(Number);return new Date(r,n-1,c).toLocaleString(void 0,{dateStyle:"medium"})},st=t=>{if(!t)return 0;try{const[r,n,c]=t.split(":").map(Number);return r*3600+n*60+c}catch{return 0}},ir=t=>{if(typeof t!="number"||isNaN(t))return"";const r=Math.floor(t/3600),n=Math.floor(t%3600/60),c=Math.floor(t%60),s=o=>o.toString().padStart(2,"0");return`${s(r)}:${s(n)}:${s(c)}`},or=t=>{if(!t)return"";const r=new Date(t);if(isNaN(r.getTime()))return"";const n=r.toLocaleString("default",{month:"long"}),c=r.getDate(),s=r.getFullYear(),h=`${c}${(b=>{const j=["th","st","nd","rd"],g=b%100;return j[(g-20)%10]||j[g]||j[0]})(c)}`,p=new Date,u=r.getTime()-p.getTime(),w=Math.ceil(u/(1e3*60*60*24));let i="";return w>0?i=` in ${w} day${w===1?"":"s"}`:w===0?i=" today":i=` ${Math.abs(w)} day${Math.abs(w)===1?"":"s"} ago`,`${n} ${h}, ${s} â€” ${i}`},lr=({open:t,setOpen:r})=>{const n=v(x=>x.theme),c=v(x=>x.density),s=v(x=>x.setTheme),o=v(x=>x.setDensity),h=v(x=>x.membershipKey),p=v(x=>x.membershipInfo),u=v(x=>x.setMembershipKey),w=v(x=>x.setMembershipInfo),[i,b]=d.useState(h),[j,g]=d.useState(!1),[S,a]=d.useState("");d.useEffect(()=>{b(h)},[h]);const T=async()=>{if(i.trim()){g(!0),a("");try{const x=await ar(i.trim());u(i.trim()),w(x)}catch(x){a(x.message)}finally{g(!1)}}},y=()=>{u(""),w(null),b(""),a("")},I=()=>{r(!1)},f=p?new Date(p.expiresAt)<new Date:!1;return e.jsxs(ae,{open:t,onClose:I,maxWidth:"xs",fullWidth:!0,children:[e.jsx(ie,{children:"Settings"}),e.jsxs(oe,{children:[e.jsxs(m,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsxs(me,{fullWidth:!0,variant:"filled",children:[e.jsx(xe,{id:"theme-select-label",children:"Theme"}),e.jsxs(ue,{labelId:"theme-select-label",name:"theme",value:n,onChange:x=>s(x.target.value),children:[e.jsx($,{value:"light",children:"Light"}),e.jsx($,{value:"system",children:"System"}),e.jsx($,{value:"dark",children:"Dark"})]})]}),e.jsxs(me,{fullWidth:!0,variant:"filled",children:[e.jsx(xe,{id:"density-select-label",children:"Density"}),e.jsxs(ue,{labelId:"density-select-label",name:"density",value:c,onChange:x=>o(x.target.value),children:[e.jsx($,{value:"compact",children:"Compact"}),e.jsx($,{value:"standard",children:"Standard"}),e.jsx($,{value:"comfortable",children:"Comfortable"})]})]})]}),e.jsxs(m,{sx:{display:"flex",flexDirection:"column",gap:2,mt:3},children:[e.jsx(l,{variant:"h6",children:"Membership"}),p?e.jsxs(m,{sx:{p:2,border:"1px solid",borderColor:f?"error.main":"primary.main",borderRadius:1},children:[e.jsxs(m,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[f?e.jsx(Ie,{color:"error"}):e.jsx(dt,{color:"success"}),e.jsx(l,{variant:"subtitle1",fontWeight:"bold",color:f?"error":"inherit",children:f?"Expired Key":"Verified"})]}),e.jsxs(l,{variant:"body2",children:[e.jsx("b",{children:"Channel:"})," ",p.channel]}),e.jsxs(l,{variant:"body2",color:f?"error":"inherit",children:[e.jsx("b",{children:f?"Expired":"Expires"}),":"," ",or(p.expiresAt)]}),e.jsx(D,{variant:"outlined",color:"error",startIcon:e.jsx(ht,{}),onClick:y,sx:{mt:2},fullWidth:!0,children:"Delete Key"})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{label:"Membership Key",variant:"outlined",fullWidth:!0,type:"text",value:i,onChange:x=>b(x.target.value),onKeyDown:x=>{x.key==="Enter"&&T()},error:!!S,helperText:S}),e.jsx(D,{variant:"contained",onClick:T,disabled:j||!i.trim(),fullWidth:!0,children:j?e.jsx(fe,{size:24}):"Verify Key"})]})]})]}),e.jsx(le,{children:e.jsx(D,{onClick:I,children:"Close"})})]})};function cr({children:t}){const r=ce(),n=v(y=>y.sidebarOpen),c=v(y=>y.setSidebarOpen),[s,o]=d.useState(!1),[h,p]=d.useState(!1),[u,w]=d.useState(!1),i=P("(max-width:768px)"),b=i?180:200,j=60,g=[{name:"Search",icon:e.jsx(_e,{}),value:"search"},{name:"Graph",icon:e.jsx(Ue,{}),value:"graph"}],S=()=>{i?o(!s):c(!n)},a=()=>{T("/")},T=y=>{i&&o(!1),r(y)};return e.jsxs(m,{sx:{display:"flex"},children:[i&&!s&&e.jsx(m,{sx:{position:"fixed",top:10,left:10,zIndex:1200,backgroundColor:"background.paper",borderRadius:"50%",boxShadow:2},children:e.jsx(_,{onClick:()=>o(!0),sx:{borderRadius:"50%",p:1},children:e.jsx(Be,{})})}),e.jsx(mt,{open:i?s:!0,variant:i?"temporary":"persistent",onClose:i?()=>o(!1):void 0,sx:{width:i||n?b:j,flexShrink:0,"& .MuiDrawer-paper":{width:i||n?b:j,boxSizing:"border-box",overflowX:"hidden",transition:"width 0.3s ease-in-out"}},children:e.jsxs(m,{sx:{overflow:"hidden"},children:[e.jsxs(xt,{children:[e.jsx(U,{disablePadding:!0,children:e.jsxs(_,{onClick:S,sx:{justifyContent:"center"},children:[e.jsx(Z,{sx:{minWidth:0},children:e.jsx(Be,{})}),(!i&&n||i)&&e.jsx(O,{primary:""})]})}),e.jsx(U,{disablePadding:!0,children:e.jsx(V,{title:!i&&!n?"Home":"",placement:"right",children:e.jsxs(_,{onClick:a,sx:{paddingLeft:!i&&!n?2.4:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:e.jsx(ut,{})}),(!i&&n||i)&&e.jsx(O,{primary:"Home"})]})})}),!i&&!n&&e.jsx(U,{sx:{height:16}}),e.jsx(O,{primary:"Pages",sx:{mt:2,ml:1,display:!i&&n||i?"block":"none"}}),g.map(y=>e.jsx(U,{disablePadding:!0,children:e.jsx(V,{title:!i&&!n?y.name:"",placement:"right",children:e.jsxs(_,{selected:window.location.pathname.split("/")[3]===y.value,onClick:()=>T(y.value),sx:{paddingLeft:!i&&!n?2:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:y.icon}),(!i&&n||i)&&e.jsx(O,{primary:y.name})]})})},y.value)),e.jsx(U,{disablePadding:!0,sx:{mt:2},children:e.jsx(V,{title:"https://github.com/duckautomata/archived-transcript",placement:"right",children:e.jsxs(_,{onClick:()=>{window.open("https://github.com/duckautomata/archived-transcript","_blank","noopener noreferrer")},sx:{paddingLeft:!i&&!n?2:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:e.jsx(pt,{})}),(!i&&n||i)&&e.jsx(O,{primary:"GitHub"})]})})}),e.jsx(U,{disablePadding:!0,children:e.jsx(V,{title:!i&&!n?"Help":"",placement:"right",children:e.jsxs(_,{onClick:()=>p(!0),sx:{paddingLeft:!i&&!n?2:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:e.jsx(ft,{})}),(!i&&n||i)&&e.jsx(O,{primary:"Help"})]})})}),e.jsx(U,{disablePadding:!0,children:e.jsx(V,{title:!i&&!n?"Settings":"",placement:"right",children:e.jsxs(_,{onClick:()=>w(!0),sx:{paddingLeft:!i&&!n?2:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:e.jsx(gt,{})}),(!i&&n||i)&&e.jsx(O,{primary:"Settings"})]})})})]}),e.jsx(lr,{open:u,setOpen:w}),e.jsx(Qt,{open:h,setOpen:p})]})}),e.jsx(m,{component:"main",sx:{flexGrow:1,padding:1,width:i?"100%":`calc(97vw - ${n?b:j}px)`,transition:"width 0.3s ease-in-out, margin-left 0.3s ease-in-out"},children:t})]})}const dr=ge("span")(({theme:t})=>({color:t.palette.primary.main})),hr=ge("span")(({theme:t})=>({"&":{color:t.palette.timestamp.main}})),mr=d.memo(function({text:r,start:n,targetWord:c,margin:s,onActionClick:o}){const h=Ne(),p=v(S=>S.density),u=new RegExp(`(${c})`,"gi"),w=r.split(u),i=h.palette.id.main,b=p==="comfortable"?"medium":"small",j=p==="compact"?{padding:0}:{},g=()=>{o(n,r)};return e.jsxs(m,{sx:{display:"flex",alignItems:"center",mt:s,textAlign:"left"},children:[e.jsx(V,{title:"Line Actions",children:e.jsx(We,{size:b,sx:j,onClick:g,children:e.jsx(qe,{style:{color:i}})})})," ",e.jsxs(l,{component:"p",sx:{ml:1,wordBreak:"break-word"},children:["[",e.jsx(hr,{theme:h,children:n}),"]"," ",e.jsx("span",{children:w.map((S,a)=>u.test(S)?e.jsx(dr,{children:e.jsx("u",{children:S})},a):e.jsx("span",{children:S},a))})]})]})}),xr=d.memo(function({stream:r,targetWord:n}){const c=ce(),s=P("(max-width:768px)"),{id:o,streamer:h,date:p,streamType:u,title:w,contexts:i}=r,b=i.length,j=b===Zt,[g,S]=d.useState(!1),[a,T]=d.useState(!1),[y,I]=d.useState({timestamp:"",lineText:"",internalJumpUrl:"",externalVideoUrl:""}),[f,x]=d.useState(!1),[E,M]=d.useState(""),K=v(F=>F.density);let N=.5;K==="standard"?N=1.5:K==="comfortable"&&(N=2.5);const he=()=>{c(`/transcript/${o}`)},q=()=>{c(`/graph/${o}`)},re=d.useCallback((F,we)=>{let Se,Me;const Te=F.split(":");if(u==="Twitch"){const ke=`${Te[0]}h${Te[1]}m${Te[2]}s`;Se=`https://www.twitch.tv/videos/${o}?t=${ke}`}else{const ke=st(F);Se=`https://www.youtube.com/watch?v=${o}&t=${ke}s`}const it=F.replace(/:/g,"-");Me=`/transcript/${o}#T${it}`,I({timestamp:F,lineText:we,internalJumpUrl:Me,externalVideoUrl:Se}),T(!0)},[u,o]),z=()=>{T(!1),I({timestamp:"",lineText:"",internalJumpUrl:"",externalVideoUrl:""})},je=()=>{let F;u==="Twitch"?F=`https://www.twitch.tv/videos/${o}`:F=`https://www.youtube.com/watch?v=${o}`,M(F),x(!0)},B=()=>{x(!1)},ye=()=>{window.open(E,"_blank").focus(),x(!1)},be=()=>{y.internalJumpUrl&&c(y.internalJumpUrl),z()},ve=()=>{y.externalVideoUrl&&navigator.clipboard.writeText(y.externalVideoUrl),z()},W=()=>{y.externalVideoUrl&&window.open(y.externalVideoUrl,"_blank").focus(),z()};let k="#5e5e5eff",C=1;u==="Video"?(k="#0f2380ff",C=1):u==="Twitch"?(k="#6441a5",C=1):u==="TwitchVod"?(k="#FF41a5",C=1):u==="External"?(k="#af6c6cff",C=1):u==="Members"&&(k="#FFD700",C=2);const H={display:"block",cursor:"pointer",padding:"12px 16px"},A={padding:"16px",borderTop:C?`1px solid ${k}`:"none"},at=F=>{S(F.currentTarget.open)};return e.jsxs(m,{component:"details",onToggle:at,sx:{mb:N,borderRadius:4,border:C?`${C}px solid ${k}`:"none",overflow:"hidden"},children:[e.jsx("summary",{style:H,children:e.jsxs(m,{sx:{alignItems:"center",width:"100%",overflow:"hidden",display:"flex",flexWrap:s?"wrap":"nowrap"},children:[e.jsx(l,{variant:"body2",sx:{flexShrink:0,mr:2,color:"text.secondary"},children:rt(p)}),e.jsx(l,{variant:"body2",sx:{flexShrink:0,mr:2,color:"text.secondary"},children:h}),e.jsx(l,{variant:"body2",sx:{flexShrink:0,mr:2,color:k,fontWeight:"bold"},children:u}),e.jsx(l,{variant:"body2",sx:{flexGrow:1,mr:2,mt:s?1:0,width:s?"100%":"auto",order:s?1:0,noWrap:!0,textOverflow:"ellipsis"},children:w}),e.jsxs(l,{variant:"body2",sx:{width:"70px",flexShrink:0,mr:s?0:2,ml:s?"auto":0,color:"text.secondary",textAlign:"right"},children:[b," found"]})]})}),g&&e.jsxs("div",{style:A,children:[e.jsxs(Ve,{direction:s?"column":"row",spacing:2,sx:{mb:2,justifyContent:"center"},children:[e.jsx(D,{variant:"contained",size:"small",onClick:he,startIcon:e.jsx(jt,{}),sx:{flexShrink:0},children:"View Full Transcript"}),e.jsx(D,{variant:"contained",size:"small",onClick:q,startIcon:e.jsx(yt,{}),sx:{flexShrink:0},children:"Graph This Stream"}),e.jsx(D,{variant:"outlined",size:"small",onClick:je,startIcon:e.jsx(bt,{}),sx:{flexShrink:0},children:"Open This Stream"})]}),j&&e.jsx(l,{children:'Note: results may be limited. To see all results, click on "View Full Transcript"'}),u==="Members"&&e.jsx(l,{variant:"h6",color:"error",sx:{mb:2,mt:2,fontWeight:"bold",p:1,borderRadius:1},children:"This is members content and should only be used for personal use, never shared."}),i.map((F,we)=>e.jsx(mr,{start:F.startTime,text:F.line,targetWord:n,margin:N,onActionClick:re},`${o}-${F.startTime}-${we}`))]}),e.jsxs(ae,{open:a,onClose:z,"aria-labelledby":"line-action-dialog-title",children:[e.jsxs(ie,{id:"line-action-dialog-title",children:["Line Action [",y.timestamp,"]"]}),e.jsxs(oe,{children:[e.jsxs(ne,{sx:{mb:2,fontStyle:"italic",wordBreak:"break-word"},children:['"',y.lineText,'"']}),e.jsx(ne,{children:"Choose an action for this line:"})]}),e.jsxs(le,{sx:{display:"flex",flexDirection:"column",p:2,gap:2,"& > :not(style)":{marginLeft:"0 !important"}},children:[e.jsx(D,{onClick:be,variant:"outlined",fullWidth:!0,children:"Jump to Line in Transcript"}),e.jsx(D,{onClick:ve,variant:"outlined",fullWidth:!0,children:"Copy External Link"}),e.jsx(D,{onClick:W,variant:"contained",fullWidth:!0,autoFocus:!0,children:"Open External Link"}),e.jsx(D,{onClick:z,color:"inherit",fullWidth:!0,sx:{mt:1},children:"Cancel"})]})]}),e.jsxs(ae,{open:f,onClose:B,"aria-labelledby":"external-nav-dialog-title",children:[e.jsx(ie,{id:"external-nav-dialog-title",children:"Confirm External Navigation"}),e.jsxs(oe,{children:[e.jsx(ne,{children:"You are about to be redirected to an external site."}),e.jsxs(ne,{sx:{mt:2,wordBreak:"break-all"},children:["URL: ",E]})]}),e.jsxs(le,{children:[e.jsx(D,{onClick:B,children:"Cancel"}),e.jsx(D,{onClick:ye,variant:"contained",color:"primary",autoFocus:!0,children:"Proceed to Site"})]})]})]})});function Le({onSearch:t}){const r=v(o=>o.searchText),n=v(o=>o.setSearchText),c=d.useRef(null);d.useEffect(()=>{const o=h=>{(h.ctrlKey||h.metaKey)&&h.key==="f"?(h.preventDefault(),c.current&&(c.current.focus(),c.current.select())):h.key==="Escape"&&c.current&&document.activeElement===c.current&&c.current.blur()};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]);const s=o=>{o.key==="Enter"&&t&&t()};return e.jsx(m,{sx:{mb:4,p:2},children:e.jsx(L,{container:!0,spacing:2,alignItems:"center",children:e.jsx(L,{size:12,children:e.jsx(G,{inputRef:c,fullWidth:!0,label:"Search Text",variant:"outlined",value:r,onChange:o=>n(o.target.value),onKeyDown:s})})})})}function nt(){const t=v(a=>a.streamer),r=v(a=>a.streamType),n=v(a=>a.fromDate),c=v(a=>a.toDate),s=v(a=>a.streamTitle),o=v(a=>a.matchWholeWord),h=v(a=>a.setStreamer),p=v(a=>a.setStreamType),u=v(a=>a.setFromDate),w=v(a=>a.setToDate),i=v(a=>a.setStreamTitle),b=v(a=>a.setMatchWholeWord),j=["Dokibird","MintFantome"],g=["Video","Stream","Twitch","Members","TwitchVod","External"],S=a=>{const{target:{value:T}}=a;p(typeof T=="string"?T.split(","):T)};return e.jsxs(e.Fragment,{children:["Filter",e.jsx(m,{sx:{mb:4,p:2},children:e.jsxs(L,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(L,{size:{xs:12,sm:6,md:3},children:e.jsxs(me,{fullWidth:!0,sx:{minWidth:80},children:[e.jsx(xe,{id:"streamer-select-label",children:"Streamer"}),e.jsxs(ue,{labelId:"streamer-select-label",label:"Streamer",value:t,onChange:a=>h(a.target.value),children:[e.jsx($,{value:"",children:"Any"}),j.map(a=>e.jsx($,{value:a,children:a},a))]})]})}),e.jsx(L,{size:{xs:12,sm:6,md:3},children:e.jsxs(me,{fullWidth:!0,sx:{minWidth:120},children:[e.jsx(xe,{id:"type-select-label",children:"Type"}),e.jsx(ue,{labelId:"type-select-label",multiple:!0,value:r,onChange:S,input:e.jsx(St,{label:"Type"}),renderValue:a=>e.jsx(m,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:a.map(T=>e.jsx(wt,{label:T,size:"small"},T))}),children:g.map(a=>e.jsxs($,{value:a,children:[e.jsx(vt,{checked:r.includes(a)}),e.jsx(O,{primary:a})]},a))})]})}),e.jsx(L,{size:{xs:12,sm:6,md:3},children:e.jsx(G,{fullWidth:!0,label:"From",type:"date",value:n,onChange:a=>u(a.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(L,{size:{xs:12,sm:6,md:3},children:e.jsx(G,{fullWidth:!0,label:"To",type:"date",value:c,onChange:a=>w(a.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(L,{size:{xs:12,sm:8},children:e.jsx(G,{fullWidth:!0,label:"Stream Title",variant:"outlined",value:s,onChange:a=>i(a.target.value)})}),e.jsx(L,{size:{xs:12,sm:4},children:e.jsx(Tt,{sx:{flexDirection:{xs:"column",sm:"row"},justifyContent:"center",gap:2},children:e.jsx(Ye,{control:e.jsx(Xe,{checked:o,onChange:a=>b(a.target.checked)}),label:"Match Whole Word"})})})]})})]})}function ur(){const t=v(Fe(g=>({searchText:g.searchText,streamer:g.streamer,streamType:g.streamType,fromDate:g.fromDate,toDate:g.toDate,streamTitle:g.streamTitle,matchWholeWord:g.matchWholeWord}))),[r,n]=d.useState(!1),[c,s]=d.useState(!1),[o,h]=d.useState(null),[p,u]=d.useState([]),[w,i]=d.useState(t.searchText),b=p.length,j=d.useCallback(async()=>{s(!0),n(!0),h(null),u([]);try{const g=await tr(t);g&&g.result&&(u(g.result),i(t.searchText))}catch(g){h(g.message||"Failed to search transcripts.")}finally{s(!1)}},[t]);return e.jsxs(pe,{sx:{padding:0},children:[e.jsxs(m,{sx:{my:4},children:[e.jsx(l,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:"Search Transcripts"}),e.jsx(Le,{onSearch:j}),e.jsx(nt,{}),e.jsx(D,{variant:"outlined",onClick:j,disabled:c,fullWidth:!0,children:c?"Searching...":"Search"})]}),e.jsxs(m,{sx:{mt:4},children:[c&&e.jsx(m,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx(fe,{})}),o&&e.jsx(R,{severity:"error",sx:{my:2},children:o}),r&&!c&&!o&&b===0&&e.jsx(R,{severity:"info",sx:{my:2},children:"No data found for the selected criteria."}),b>0&&!c&&e.jsxs(m,{children:[e.jsxs(l,{variant:"body2",sx:{mb:2,textAlign:"center",color:"text.secondary"},children:["Found ",b," streams"]}),e.jsx(Je,{style:{height:"80vh",marginBottom:"40px"},data:p,itemContent:(g,S)=>e.jsx(xr,{stream:S,targetWord:w},S.id)})]})]})]})}function pr(){const[t,r]=d.useState([]),[n,c]=d.useState(!1),[s,o]=d.useState(null),[h,p]=d.useState(null),[u,w]=d.useState(!1),[i,b]=d.useState(!1),j=v(Fe(a=>({searchText:a.searchText,streamer:a.streamer,streamType:a.streamType,fromDate:a.fromDate,toDate:a.toDate,streamTitle:a.streamTitle,matchWholeWord:a.matchWholeWord}))),g=d.useCallback(async()=>{if(w(!0),r([]),p(null),!j.searchText||j.searchText.trim()===""){o("Search text cannot be empty. Please enter a search term.");return}c(!0),o(null);try{const a=await sr(j);if(a&&a.result&&(r(a.result),a.result.length>0)){const T=a.result.reduce((I,f)=>I+f.y,0),y=Math.max(...a.result.map(I=>I.y));p({total:T,max:y})}}catch(a){o(a.message||"Failed to fetch graph data.")}finally{c(!1)}},[j]),S=d.useMemo(()=>{if(!i)return t.map(T=>{const[y,I,f]=T.x.split("-").map(Number);return{x:new Date(y,I-1,f),y:T.y}});let a=0;return t.map(T=>{const[y,I,f]=T.x.split("-").map(Number),x=new Date(y,I-1,f);return a+=T.y,{x,y:a}})},[t,i]);return e.jsx(pe,{sx:{padding:0},children:e.jsxs(m,{sx:{my:4},children:[e.jsx(l,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:"Graph Transcripts"}),e.jsx(Le,{onSearch:g}),e.jsx(nt,{}),e.jsx(D,{variant:"outlined",fullWidth:!0,onClick:g,disabled:n,children:n?"Graphing...":"Graph"}),e.jsxs(m,{sx:{mt:4},children:[n&&e.jsx(m,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx(fe,{})}),s&&e.jsx(R,{severity:"error",sx:{my:2},children:s}),u&&!n&&!s&&t.length===0&&e.jsx(R,{severity:"info",sx:{my:2},children:"No data found for the selected criteria."}),t.length>0&&!n&&e.jsxs(m,{children:[e.jsx(Ye,{control:e.jsx(Xe,{checked:i,onChange:a=>b(a.target.checked)}),label:"Show Cumulative Sum",sx:{mb:1,display:"block"}}),h&&e.jsxs(m,{sx:{mb:2},children:[e.jsx(l,{variant:"h6",component:"h6",gutterBottom:!0,children:"Graph Statistics"}),e.jsxs(l,{variant:"body1",children:[e.jsx("b",{children:"Total Hits:"})," ",h.total.toLocaleString()]}),!i&&e.jsxs(l,{variant:"body1",children:[e.jsx("b",{children:"Max Hits (in one day):"})," ",h.max.toLocaleString()]})]}),e.jsx(m,{sx:{height:500,width:"100%"},children:e.jsx(Qe,{dataset:S,series:[{dataKey:"y",label:i?"Cumulative Count":"Count",showMark:!1,curve:"linear"}],xAxis:[{scaleType:"time",dataKey:"x",label:"Date",valueFormatter:a=>a?a.toLocaleString(void 0,{dateStyle:"medium"}):""}],yAxis:[{label:i?"Cumulative Count":"Count",min:0}],tooltip:{trigger:"axis"},grid:{vertical:!1,horizontal:!0}})})]})]})]})})}function fr(){const t=P("(max-width:768px)"),r=Math.max(Math.ceil((window.innerHeight-200)/36),1),n=Array.from(new Array(r));return e.jsxs(m,{sx:{height:"95vh",overflow:"hidden"},children:[e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(se,{variant:"text",width:"90%",height:40,sx:{mb:1}}),e.jsx(l,{variant:"h5",color:"primary",sx:{mb:1},children:"Loading Transcript..."})]}),e.jsxs("div",{className:"transcript",children:[e.jsx(m,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center",mb:3},children:e.jsx(se,{variant:"rounded",width:t?"100%":"50%",height:30})}),n.map((c,s)=>{const o=Math.max(1-s/n.length,.15);return e.jsxs(m,{sx:{display:"flex",alignItems:"center",mb:1.5,opacity:o},children:[e.jsx(se,{variant:"circular",width:24,sx:{mr:1}}),e.jsx(se,{variant:"text",width:80,sx:{mr:1}}),e.jsx(se,{variant:"text",width:"100%"})]},s)})]})]})}const gr=ge("span")(({theme:t})=>({"&":{color:t.palette.timestamp.main}})),jr=ge("span")(({theme:t})=>({backgroundColor:t.palette.mode==="dark"?"rgba(255, 255, 0, 0.4)":"rgba(255, 255, 0, 0.8)",color:t.palette.mode==="dark"?"#fff":"#000",borderRadius:"2px",padding:"0 2px",textDecoration:"underline"})),yr=d.memo(function({id:r,start:n,text:c,searchTerm:s,handleClick:o}){const h=Ne(),p=v(j=>j.density),u=h.palette.id.main,w=p==="comfortable"?"medium":"small",i=p==="compact"?{padding:0}:{},b=d.useMemo(()=>{if(!s||!s.trim())return c;try{const j=new RegExp(`(${s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return c.split(j).map((S,a)=>j.test(S)?e.jsx(jr,{children:S},a):S)}catch{return c}},[c,s]);return e.jsx(m,{id:r,sx:{padding:"1px 0","&:hover":{backgroundColor:h.palette.action.hover}},children:e.jsxs(l,{color:"secondary","aria-live":"assertive",whiteSpace:"pre-wrap",align:"left",style:{wordBreak:"break-word"},children:[e.jsx(V,{title:"Open video at timestamp",children:e.jsx(We,{size:w,sx:{...i,verticalAlign:"middle"},onClick:()=>o(n),children:e.jsx(qe,{style:{color:u}})})})," ","[",e.jsx(gr,{theme:h,children:n}),"] ",b]})})});function br(){const{id:t}=Ze(),r=ce(),n=kt(),c=d.useRef(null),s=P("(max-width:768px)"),o=d.useRef(null),[h,p]=d.useState(""),[u,w]=d.useState(""),[i,b]=d.useState(""),[j,g]=d.useState(""),[S,a]=d.useState([]),[T,y]=d.useState(!0),[I,f]=d.useState(null),[x,E]=d.useState(!1),[M,K]=d.useState(""),[N,he]=d.useState(""),[q,re]=d.useState(""),z=S.filter(W=>W.text.toLowerCase().includes(q.toLowerCase())),je=d.useCallback(W=>{let k;const C=W.split(":");if(i==="Twitch"){const A=`${C[0]}h${C[1]}m${C[2]}s`;k=`https://www.twitch.tv/videos/${t}?t=${A}`}else{const A=+C[0]*3600+ +C[1]*60+ +C[2];k=`https://www.youtube.com/watch?v=${t}&t=${A}s`}const H=W.replace(/:/g,"-");he(`/transcript/${t}#T${H}`),K(k),E(!0)},[i,t]),B=()=>{E(!1),K(""),he("")},ye=()=>{re(""),r(N),B()},be=()=>{M&&navigator.clipboard.writeText(M),B()},ve=()=>{M&&window.open(M,"_blank").focus(),B()};return d.useEffect(()=>{let W=!0;async function k(){y(!0),f(null),a([]);try{const C=await er(t);W&&(p(C.date),w(C.streamTitle),b(C.streamType),g(C.streamer),a(C.transcriptLines||[]))}catch(C){W&&f({message:C.message||"Failed to fetch transcript data.",status:C.status||null})}finally{W&&y(!1)}}return k(),()=>{W=!1}},[t]),d.useEffect(()=>{if(T||S.length===0||!c.current||!n.hash||!n.hash.startsWith("#T"))return;const k=n.hash.substring(2).replace(/-/g,":");if(!k)return;const C=S.findIndex(A=>A.start===k),H=S[C]?.id;C===-1||!H||setTimeout(()=>{c.current&&(c.current.scrollToIndex({index:C,align:"start"}),setTimeout(()=>{const A=document.getElementById(H);A&&(A.classList.add("highlight"),setTimeout(()=>{document.getElementById(H)&&A.classList.remove("highlight")},2e3))},150))},100)},[T,S,n.hash]),d.useEffect(()=>{const W=k=>{(k.ctrlKey||k.metaKey)&&k.key==="f"?(k.preventDefault(),o.current&&(o.current.focus(),o.current.select())):k.key==="Escape"&&o.current&&document.activeElement===o.current&&o.current.blur()};return window.addEventListener("keydown",W),()=>{window.removeEventListener("keydown",W)}},[]),e.jsxs(m,{sx:{width:"100%"},children:[T?e.jsx(fr,{}):e.jsx(e.Fragment,{children:I?e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",height:"50vh"},children:[I.status===404?e.jsxs(e.Fragment,{children:[e.jsx(et,{color:"primary",sx:{fontSize:60,mb:2}}),e.jsx(l,{variant:"h5",component:"h2",sx:{mb:1},children:"404 Not Found"}),e.jsx(l,{color:"text.secondary",children:I.message})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{color:"error",sx:{fontSize:60,mb:2}}),e.jsx(l,{variant:"h5",component:"h2",sx:{mb:1},children:"Error fetching transcripts"}),e.jsx(l,{color:"text.secondary",children:I.message})]}),e.jsx(D,{variant:"contained",onClick:()=>r("/"),sx:{mt:2},children:"Go Back Home"})]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:u}),i==="Members"&&e.jsx(Pe,{elevation:4,sx:{position:"sticky",top:0,zIndex:10,p:1.5,mb:2,border:"2px solid",borderColor:"error.main",borderRadius:2},children:e.jsxs(l,{variant:"h6",color:"error",sx:{fontWeight:"bold",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[e.jsx(Ie,{})," This is members content and should only be used for personal use, never shared."]})}),e.jsxs(l,{sx:{mb:2},children:[rt(h)," - ",i," - ",j]}),e.jsxs(m,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center",mb:2},children:[e.jsx(G,{inputRef:o,label:"Search Transcript",variant:"outlined",size:"small",value:q,onChange:W=>re(W.target.value),slotProps:{input:{startAdornment:e.jsx(Ct,{position:"start",children:e.jsx(Dt,{})})}},sx:{width:s?"100%":"50%"}}),q&&e.jsx(We,{onClick:()=>{re("")},"aria-label":"clear search",children:e.jsx(It,{})})]}),e.jsx("hr",{}),e.jsx(Je,{ref:c,useWindowScroll:!0,style:{height:i==="Members"?s?"calc(100svh - 120px)":"calc(100vh - 250px)":s?"calc(100svh - 120px)":"calc(100vh - 180px)"},data:z,itemContent:(W,k)=>e.jsx(yr,{id:k.id,start:k.start,text:k.text,searchTerm:q,handleClick:je},k.id?`line-${k.id}`:`line-idx-${W}`)})]})}),e.jsxs(ae,{open:x,onClose:B,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ie,{id:"alert-dialog-title",children:"Confirm External Navigation"}),e.jsxs(oe,{children:[e.jsx(ne,{id:"alert-dialog-description",children:"You are about to open an external site in a new tab. Do you want to continue?"}),e.jsx(l,{variant:"body2",sx:{mt:2,wordBreak:"break-all",color:"text.secondary"},children:M})]}),e.jsxs(le,{children:[e.jsx(D,{onClick:B,children:"Cancel"}),e.jsx(D,{onClick:ye,children:"Jump to line"}),e.jsx(D,{onClick:be,children:"Copy Instead"}),e.jsx(D,{onClick:ve,autoFocus:!0,children:"Continue"})]})]})]})}function vr(){const{id:t}=Ze(),r=ce(),[n,c]=d.useState(null),[s,o]=d.useState(null),[h,p]=d.useState([]),[u,w]=d.useState(!1),[i,b]=d.useState(null),[j,g]=d.useState(null),[S,a]=d.useState(!1),T=v(Fe(f=>({searchText:f.searchText,streamer:f.streamer,streamType:f.streamType,from:f.fromDate,to:f.toDate,streamTitle:f.streamTitle,matchWholeWord:f.matchWholeWord})));d.useEffect(()=>{if(!t){o({message:"No transcript ID found in URL.",status:404});return}let f=!0;o(null);async function x(){try{const E=await nr(t);f&&c(E)}catch(E){f&&o({message:E.message||"Failed to fetch stream metadata.",status:E.status||null})}}return x(),()=>{f=!1}},[t]);const y=d.useCallback(async()=>{if(a(!0),p([]),g(null),!t){b("No transcript ID found in URL.");return}if(T.searchText===""){b("Search text cannot be empty. Please enter a search term.");return}w(!0),b(null);try{const f=await rr(t,T);if(f&&f.result){if(p(f.result),f.result.length>0){const x=f.result.reduce((M,K)=>M+K.y,0),E=Math.max(...f.result.map(M=>M.y));g({total:x,max:E})}}else p([])}catch(f){b(f.message||"Failed to fetch graph data.")}finally{w(!1)}},[t,T]),I=d.useMemo(()=>{if(!h.length)return[];let f=0;return h.map(x=>{const E=st(x.x);return f+=x.y,{x:E,y:f}})},[h]);return e.jsx(pe,{sx:{padding:0},children:s?.status===404?e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",height:"50vh"},children:[e.jsx(et,{color:"primary",sx:{fontSize:60,mb:2}}),e.jsx(l,{variant:"h5",component:"h2",sx:{mb:1},children:"404 Not Found"}),e.jsx(l,{color:"text.secondary",children:s.message}),e.jsx(D,{variant:"contained",onClick:()=>r("/"),sx:{mt:2},children:"Go Back Home"})]}):e.jsxs(m,{sx:{my:4},children:[e.jsx(l,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:n?`Graph: ${n.streamTitle}`:"Graph Transcript"}),n&&e.jsxs(m,{sx:{mb:2,typography:"body2",color:"text.secondary",pl:.5},children:[n.streamType==="Members"&&e.jsx(l,{variant:"subtitle1",color:"error",sx:{mb:2,fontWeight:"bold",border:"1px solid red",p:1,borderRadius:1},children:"This is members content and should only be used for personal use, never shared."}),e.jsxs(l,{variant:"body2",children:[e.jsx("b",{children:"Streamer:"})," ",n.streamer," "," - ",e.jsx("b",{children:"Date:"})," ",n.date," "," - ",e.jsx("b",{children:"Type:"})," ",n.streamType]})]}),s&&e.jsx(R,{severity:"error",sx:{my:2},children:s}),e.jsx(Le,{}),e.jsx(D,{variant:"outlined",fullWidth:!0,onClick:y,disabled:u,children:u?"Graphing...":"Graph"}),e.jsxs(m,{sx:{mt:4},children:[u&&e.jsx(m,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx(fe,{})}),i&&e.jsx(R,{severity:"error",sx:{my:2},children:i}),S&&!u&&!i&&h.length===0&&e.jsx(R,{severity:"info",sx:{my:2},children:"No data found for the selected criteria."}),h.length>0&&!u&&e.jsxs(m,{children:[j&&e.jsxs(m,{sx:{mb:2},children:[e.jsx(l,{variant:"h6",component:"h6",gutterBottom:!0,children:"Graph Statistics"}),e.jsxs(l,{variant:"body1",children:[e.jsx("b",{children:"Total Hits:"})," ",j.total.toLocaleString()]})]}),e.jsx(m,{sx:{height:400,width:"100%"},children:e.jsx(Qe,{dataset:I,series:[{dataKey:"y",label:"Cumulative Count",showMark:!1,curve:"linear"}],xAxis:[{scaleType:"linear",dataKey:"x",label:"Time",valueFormatter:ir}],yAxis:[{label:"Cumulative Count",min:0}],tooltip:{trigger:"axis"},grid:{vertical:!1,horizontal:!0}})})]})]})]})})}const wr=(t=300*1e3)=>{const[r,n]=d.useState(!1),c=async()=>{try{const s=await fetch("/archived-transcript/version.json",{cache:"no-store"});if(!s.ok)return;const o=await s.json();o.buildTime>1768336765032&&(console.log("Update available!",o.buildTime,1768336765032),n(!0))}catch(s){console.error("Failed to check for updates:",s)}};return d.useEffect(()=>{c();const s=setInterval(c,t);return()=>clearInterval(s)},[t]),{updateAvailable:r}},Sr=()=>{const{updateAvailable:t}=wr(),r=()=>{window.location.reload(!0)};return e.jsx(Wt,{open:t,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{width:"90%",maxWidth:500,top:{xs:"12px !important",sm:"24px !important"},left:"50% !important",transform:"translateX(-50%) !important"},children:e.jsxs(R,{severity:"info",variant:"filled",icon:!1,sx:{alignItems:"center",width:"100%",backgroundColor:"#17786E",backdropFilter:"blur(8px)",color:"#FFFFFF",fontWeight:500,boxShadow:"0 4px 20px rgba(0,0,0,0.4)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.2)"},action:e.jsx(D,{variant:"contained",size:"small",startIcon:e.jsx(Et,{}),onClick:r,sx:{backgroundColor:"#FFFFFF",color:"black",borderRadius:"8px",textTransform:"none",fontWeight:"bold",px:2,whiteSpace:"nowrap",boxShadow:"0 2px 10px rgba(0,0,0,0.3)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"0 4px 12px rgba(0,0,0,0.4)"}},children:"Update"}),children:[e.jsx(Ft,{children:"Update Available"}),"Refresh the page or click the update button to update the website."]})})};function Tr(){const t=v(c=>c.theme);let n=P("(prefers-color-scheme: dark)")?Ge:Re;return t==="light"?n=Re:t==="dark"&&(n=Ge),e.jsxs(Lt,{theme:n,children:[e.jsx(Mt,{}),e.jsx(Sr,{}),window.maintenance?e.jsx(Oe,{children:e.jsx(ee,{path:"*",element:e.jsx(Rt,{})})}):e.jsx(e.Fragment,{children:e.jsx(cr,{children:e.jsxs(Oe,{children:[e.jsx(ee,{path:"*",element:e.jsx(Gt,{})}),e.jsx(ee,{path:"search/",element:e.jsx(ur,{})}),e.jsx(ee,{path:"graph/",element:e.jsx(pr,{})}),e.jsx(ee,{path:"graph/:id",element:e.jsx(vr,{})}),e.jsx(ee,{path:"transcript/:id",element:e.jsx(br,{})})]})})})]})}At.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx($t,{basename:"archived-transcript",children:e.jsx(Tr,{})})}));
