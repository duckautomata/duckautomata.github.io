import{c as Be,r as Oe,o as Ge,a as rt,p as st,u as ce,b as z,d,j as e,B as m,T as c,G as L,e as D,M as Ke,A as _e,f as G,E as nt,D as ae,g as ie,h as oe,i as X,k as Y,l as J,m as Q,n as le,P as He,F as me,I as xe,S as ue,q as A,s as ke,C as at,t as it,v as pe,L as P,w as Le,x as ot,y as lt,z as R,H as Z,J as O,K as V,N as ct,O as dt,Q as ht,R as mt,U as fe,V as Ue,W as Ce,X as Pe,Y as xt,Z as ut,_ as pt,$ as ft,a0 as ne,a1 as gt,a2 as jt,a3 as yt,a4 as bt,a5 as Re,a6 as Ve,a7 as De,a8 as Ie,a9 as K,aa as ze,ab as Ne,ac as se,ad as qe,ae as vt,af as Xe,ag as wt,ah as Tt,ai as St,aj as kt,ak as Ct,al as Dt,am as It,an as Wt,ao as Me,ap as ee,aq as Ft,ar as Et}from"./vendor-DU1vqvMS.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const $e=Be({palette:{mode:"dark",id:{main:"#20A79A",clip:Ge[900],background:"#FFFFFF"},timestamp:{main:"#8093E0"},lineground:{main:"#395553",clip:"#39254D"},primary:{main:"#20A79A",background:"#FFFFFF"},secondary:{main:"#FFFFFF",background:"#17786E"},background:{main:"#424242"},error:{main:Oe.A400}}}),Ae=Be({palette:{mode:"light",id:{main:"#12645B",clip:Ge[900],background:"#22B9AA"},timestamp:{main:"#304BC5"},lineground:{main:"#89A5A3",clip:"#C5B4E3"},primary:{main:"#12645B",background:"#FFFFFF"},secondary:{main:"#000000",background:"#22B9AA"},background:{main:"#17786E"},error:{main:Oe.A400}}}),Lt=t=>({searchText:"",setSearchText:r=>t({searchText:r}),streamer:"",setStreamer:r=>t({streamer:r}),streamType:[],setStreamType:r=>t({streamType:r}),fromDate:"",setFromDate:r=>t({fromDate:r}),toDate:"",setToDate:r=>t({toDate:r}),streamTitle:"",setStreamTitle:r=>t({streamTitle:r}),matchWholeWord:!1,setMatchWholeWord:r=>t({matchWholeWord:r})}),Mt=t=>({theme:"system",density:"standard",timeFormat:"relative",transcriptHeight:"100%",enableTagHelper:!1,defaultOffset:-20,sidebarOpen:!0,devMode:!1,membershipKey:"",membershipInfo:null,useVirtualList:!1,setTheme:r=>t({theme:r}),setDensity:r=>t({density:r}),setTimeFormat:r=>t({timeFormat:r}),setTranscriptHeight:r=>t({transcriptHeight:r}),setEnableTagHelper:r=>t({enableTagHelper:r}),setDefaultOffset:r=>t({defaultOffset:r}),setSidebarOpen:r=>t({sidebarOpen:r}),setDevMode:r=>t({devMode:r}),setMembershipKey:r=>t({membershipKey:r}),setMembershipInfo:r=>t({membershipInfo:r}),setUseVirtualList:r=>t({useVirtualList:r})}),v=rt()(st((t,r,n)=>({...Lt(t),...Mt(t)}),{name:"live-transcript-settings",partialize:t=>({theme:t.theme,density:t.density,timeFormat:t.timeFormat,transcriptHeight:t.transcriptHeight,enableTagHelper:t.enableTagHelper,defaultOffset:t.defaultOffset,sidebarOpen:t.sidebarOpen,devMode:t.devMode,membershipKey:t.membershipKey,membershipInfo:t.membershipInfo,useVirtualList:t.useVirtualList})}));function $t(){const t=ce(),r=z("(max-width:599px)"),[n,l]=d.useState(""),[s,i]=d.useState(""),h=()=>{n.trim()&&t(`/transcript/${n.trim()}`)},p=()=>{s.trim()&&t(`/graph/${s.trim()}`)},u=o=>{o.key==="Enter"&&h()},w=o=>{o.key==="Enter"&&p()};return e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center",p:4,gap:2},children:[r?e.jsx(c,{color:"primary",variant:"h4",component:"h4",gutterBottom:!0,children:"Archived Transcripts"}):e.jsx(c,{color:"primary",variant:"h2",component:"h2",gutterBottom:!0,children:"Archived Transcripts"}),e.jsxs(L,{container:!0,spacing:6,sx:{my:4},children:[e.jsx(L,{size:{xs:12,sm:6},children:e.jsx(D,{fullWidth:!0,component:"label",role:void 0,variant:"outlined",tabIndex:-1,startIcon:e.jsx(Ke,{}),onClick:()=>t("/search"),sx:{height:100,minWidth:r?"auto":150},children:"Search"})}),e.jsx(L,{size:{xs:12,sm:6},children:e.jsx(D,{fullWidth:!0,component:"label",role:void 0,variant:"outlined",tabIndex:-1,startIcon:e.jsx(_e,{}),onClick:()=>t("/graph"),sx:{height:100,minWidth:r?"auto":150},children:"Graph"})})]}),e.jsxs(m,{sx:{display:"flex",flexDirection:"column",gap:2,width:"100%",maxWidth:500,mt:2},children:[e.jsxs(m,{sx:{display:"flex",flexDirection:r?"column":"row",gap:1},children:[e.jsx(G,{fullWidth:!0,label:"View Transcript by ID",variant:"outlined",value:n,onChange:o=>l(o.target.value),onKeyDown:u}),e.jsx(D,{variant:"contained",onClick:h,disabled:!n.trim(),fullWidth:r,sx:{minWidth:r?"auto":"80px"},children:"View"})]}),e.jsxs(m,{sx:{display:"flex",flexDirection:r?"column":"row",gap:1},children:[e.jsx(G,{fullWidth:!0,label:"Graph Stream by ID",variant:"outlined",value:s,onChange:o=>i(o.target.value),onKeyDown:w}),e.jsx(D,{variant:"contained",onClick:p,disabled:!s.trim(),fullWidth:r,sx:{minWidth:r?"auto":"80px"},children:"Graph"})]})]}),e.jsx(c,{paddingTop:r?3:10,children:"Looking for the transcript of an active stream instead?"}),e.jsx(D,{href:"/live-transcript",variant:"outlined",children:"Go to Live-Transcript"})]})}function At(){return e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",height:"50vh"},children:[e.jsx(nt,{color:"error",sx:{fontSize:60,mb:2}}),e.jsx(c,{variant:"h5",component:"h2",sx:{mb:1},children:"Archived Transcript is currently down for maintenance."}),e.jsx(c,{color:"text.secondary",children:window.maintenanceText1}),e.jsx(c,{color:"text.secondary",children:window.maintenanceText2})]})}const Bt="/archived-transcript/assets/membership-setting-empty-light-BLpuD1rC.png",Ot="/archived-transcript/assets/membership-setting-set-light-BFpSlQrQ.png",Gt="/archived-transcript/assets/membership-example-stream-light-Cvt2m45H.png",Kt="/archived-transcript/assets/search-empty-light-ae3s9cTI.png",_t="/archived-transcript/assets/search-notext-light-DtWOKsXX.png",Ht="/archived-transcript/assets/search-text-light-B-aNugVU.png",Ut="/archived-transcript/assets/membership-setting-empty-dark-B_xuXG27.png",Pt="/archived-transcript/assets/membership-setting-set-dark-U7bfrawS.png",Rt="/archived-transcript/assets/membership-example-stream-dark-DXvwav2E.png",Vt="/archived-transcript/assets/search-empty-dark-BSedxSU1.png",zt="/archived-transcript/assets/search-notext-dark-mm0QIbfN.png",Nt="/archived-transcript/assets/search-text-dark-4wMiq-z3.png",te=({src:t,width:r="100%",alt:n=""})=>e.jsx(He,{elevation:3,sx:{my:2,p:.5,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider",borderRadius:1,width:"fit-content",maxWidth:"100%",mx:"auto",overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:t,alt:n,style:{width:r,maxWidth:"100%",height:"auto",display:"block",margin:"0 auto"}})});function qt({open:t,setOpen:r}){const n=v(p=>p.theme),l=z("(prefers-color-scheme: dark)"),s=n==="dark"||n==="system"&&l,i={membershipSettingEmpty:s?Ut:Bt,membershipSettingSet:s?Pt:Ot,membershipExampleStream:s?Rt:Gt,searchEmpty:s?Vt:Kt,searchNoText:s?zt:_t,searchText:s?Nt:Ht},h=()=>{r(!1)};return e.jsx("div",{children:e.jsxs(ae,{open:t,onClose:h,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ie,{id:"alert-dialog-title",children:"How to Use Archived Transcript"}),e.jsx(oe,{children:e.jsxs("div",{children:[e.jsxs(X,{children:[e.jsx(Y,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(c,{children:"Settings"})}),e.jsxs(Q,{children:[e.jsx(c,{variant:"body1",gutterBottom:!0,children:"Settings are at the left of the page. Click the cogwheel icon to view the settings menu."}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"There are currently 3 settings. All settings are stored in local storage and persist across sessions."}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Theme: Select the color theme of the site. Light, Dark, or System default.",e.jsx("blockquote",{children:"System default will use whatever you set in your operating system. This is set by default."})]}),e.jsxs("li",{children:["Density: How much space should be between lines.",e.jsx("blockquote",{children:"Select whichever makes it easier to read."})]})]}),'The third setting is explained in the "Membership" section.']})]}),e.jsxs(X,{children:[e.jsx(Y,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(c,{children:"Sidebar"})}),e.jsxs(Q,{children:[e.jsx(c,{variant:"body1",gutterBottom:!0,children:"Allows you to easily jump between pages. Located on the left of your screen."}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"Sidebar is broken up into 2 parts."}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Pages",e.jsx("blockquote",{children:"Select how you want to query the transcripts. Either search them, or graph them."})]}),e.jsxs("li",{children:["Other",e.jsx("blockquote",{children:"General options. View github url, open the help menu (this), or change the site settings."})]})]})]})]}),e.jsxs(X,{children:[e.jsx(Y,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(c,{children:"Search"})}),e.jsxs(Q,{children:[e.jsx(c,{variant:"body1",gutterBottom:!0,children:"You can search for when something was said and in what stream it was said in. You can also use filters to refine your search."}),e.jsx(te,{src:i.searchEmpty,alt:"Empty Search"}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:'Match Whole Word means it will not include any substrings of your search text. For example: say you search for "ball". If Match Whole Word is enabled, then it will only return results for "ball" and not "balls" or "baller".'}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"If search text is empty, then it will try to find all streams that match the filter, but return no text."}),e.jsx(te,{src:i.searchNoText,alt:"No Text Search"}),e.jsx("br",{}),e.jsxs(c,{variant:"body1",gutterBottom:!0,children:["Once the search has been completed, you will see a list of streams that fit the criteria. You can click on a stream to:",e.jsxs("ul",{children:[e.jsx("li",{children:"view contexts of your search text"}),e.jsx("li",{children:"Click a button to view the entire transcript for that stream"}),e.jsx("li",{children:"Click a button to graph that stream only"})]})]}),e.jsx(te,{src:i.searchText,alt:"Text Search"}),e.jsxs(c,{variant:"body1",gutterBottom:!0,children:["You can also click on the link button on a context line to:",e.jsxs("ul",{children:[e.jsx("li",{children:"Jump to the transcript at that timestamp"}),e.jsx("li",{children:"Copy the link to the stream at that timestamp"}),e.jsx("li",{children:"Open the stream at that timestamp in a new tab"})]})]})]})]}),e.jsxs(X,{children:[e.jsx(Y,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(c,{children:"Graph"})}),e.jsxs(Q,{children:[e.jsxs(c,{variant:"body1",gutterBottom:!0,children:["You can graph word or phase usage over time. There are two types of graph:",e.jsxs("ul",{children:[e.jsx("li",{children:"Across multiple streams"}),e.jsx("li",{children:"Across a single stream"})]})]}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:'The multi-stream graph can be accessed by clicking the graph button in the sidebar. The single-stream graph can only be accessed by clicking the "Graph This Stream" button on the search page.'}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"Graphing functions the same as searching, with the only difference being you view a graph instead of a list of streams."}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"Once graphed, you can switch between a cumulative sum or a rate over time (default)."})]})]}),e.jsxs(X,{children:[e.jsx(Y,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(c,{children:"Transcript"})}),e.jsxs(Q,{children:[e.jsx(c,{variant:"body1",gutterBottom:!0,children:'You can view the entire transcript for a stream by clicking the "View Full Transcript" button on the search page.'}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"The transcript view is the exact same as on Live-Transcript. You can click the link button on the left of a line to either open the stream at that timestamp or copy the link to it."})]})]}),e.jsxs(X,{children:[e.jsx(Y,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(c,{children:"Membership"})}),e.jsxs(Q,{children:[e.jsx(c,{variant:"body1",gutterBottom:!0,children:"In order to search through members transcripts, you must have a valid key. Each streamer has their own key, and you can only use one key at a time. This means that you cannot search through members streams of multiple streamers at the same time."}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"To verify your key, go to settings"}),e.jsx(te,{src:i.membershipSettingEmpty,alt:"Empty Membership Setting"}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"Enter the key, and click verify. If valid, it will be saved and you will see what streamer it is valid for, and when it expires."}),e.jsx(te,{src:i.membershipSettingSet,alt:"Membership Setting Set Successfully"}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"You can set a new key by deleting the key and verifying a new one."}),e.jsx(c,{variant:"body1",gutterBottom:!0,children:"Once the key is verified, you will be able to search through and graph members streams."}),e.jsx(te,{src:i.membershipExampleStream,alt:"Example Membership Stream"})]})]})]})}),e.jsx(le,{children:e.jsx(D,{onClick:h,children:"Close"})})]})})}const Ye="https://archive.dokiscripts.com",Xt=20;async function de(t,r={}){const n={Accept:"application/json",...r.headers},l=v.getState().membershipKey;l&&(n["X-Membership-Key"]=l);const s=await fetch(`${Ye}${t}`,{...r,method:"GET",headers:n});if(!s.ok){const i=`HTTP error ${s.status}: ${s.statusText}`,h=s.status;let p="";try{p=(await s.json()).error||i}catch{p=i}const u=new Error(p);throw u.status=h,u}return s.status===204?null:await s.json()}function We(t){if(!t)return"";const r=new URLSearchParams;Object.entries(t).forEach(([l,s])=>{s!=null&&(Array.isArray(s)?s.forEach(i=>r.append(l,i)):r.append(l,s.toString()))});const n=r.toString();return n?`?${n}`:""}async function Yt(t){if(!t)throw new Error("Transcript ID is required");return de(`/transcript/${t}`)}async function Jt(t){const r=We(t);return de(`/transcripts${r}`)}async function Qt(t,r={}){if(!t)throw new Error("Graph ID is required");const n={searchText:r.searchText,matchWholeWord:r.matchWholeWord},l=We(n);return de(`/graph/${t}${l}`)}async function Zt(t){const r=We(t);return de(`/graph${r}`)}async function er(t){return de(`/stream/${t}`)}async function tr(t){const r=await fetch(`${Ye}/membership/verify`,{method:"GET",headers:{Accept:"application/json","X-Membership-Key":t}});if(!r.ok)throw r.status===401?new Error("Invalid membership key"):new Error(`Verification failed: ${r.statusText}`);return await r.json()}const Je=t=>{if(t==="")return;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return null;const[r,n,l]=t.split("-").map(Number);return new Date(r,n-1,l).toLocaleString(void 0,{dateStyle:"medium"})},Qe=t=>{if(!t)return 0;try{const[r,n,l]=t.split(":").map(Number);return r*3600+n*60+l}catch{return 0}},rr=t=>{if(typeof t!="number"||isNaN(t))return"";const r=Math.floor(t/3600),n=Math.floor(t%3600/60),l=Math.floor(t%60),s=i=>i.toString().padStart(2,"0");return`${s(r)}:${s(n)}:${s(l)}`},sr=t=>{if(!t)return"";const r=new Date(t);if(isNaN(r.getTime()))return"";const n=r.toLocaleString("default",{month:"long"}),l=r.getDate(),s=r.getFullYear(),h=`${l}${(b=>{const j=["th","st","nd","rd"],g=b%100;return j[(g-20)%10]||j[g]||j[0]})(l)}`,p=new Date,u=r.getTime()-p.getTime(),w=Math.ceil(u/(1e3*60*60*24));let o="";return w>0?o=` in ${w} day${w===1?"":"s"}`:w===0?o=" today":o=` ${Math.abs(w)} day${Math.abs(w)===1?"":"s"} ago`,`${n} ${h}, ${s} â€” ${o}`},nr=({open:t,setOpen:r})=>{const n=v(x=>x.theme),l=v(x=>x.density),s=v(x=>x.setTheme),i=v(x=>x.setDensity),h=v(x=>x.membershipKey),p=v(x=>x.membershipInfo),u=v(x=>x.setMembershipKey),w=v(x=>x.setMembershipInfo),[o,b]=d.useState(h),[j,g]=d.useState(!1),[T,a]=d.useState("");d.useEffect(()=>{b(h)},[h]);const S=async()=>{if(o.trim()){g(!0),a("");try{const x=await tr(o.trim());u(o.trim()),w(x)}catch(x){a(x.message)}finally{g(!1)}}},y=()=>{u(""),w(null),b(""),a("")},I=()=>{r(!1)},f=p?new Date(p.expiresAt)<new Date:!1;return e.jsxs(ae,{open:t,onClose:I,maxWidth:"xs",fullWidth:!0,children:[e.jsx(ie,{children:"Settings"}),e.jsxs(oe,{children:[e.jsxs(m,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsxs(me,{fullWidth:!0,variant:"filled",children:[e.jsx(xe,{id:"theme-select-label",children:"Theme"}),e.jsxs(ue,{labelId:"theme-select-label",name:"theme",value:n,onChange:x=>s(x.target.value),children:[e.jsx(A,{value:"light",children:"Light"}),e.jsx(A,{value:"system",children:"System"}),e.jsx(A,{value:"dark",children:"Dark"})]})]}),e.jsxs(me,{fullWidth:!0,variant:"filled",children:[e.jsx(xe,{id:"density-select-label",children:"Density"}),e.jsxs(ue,{labelId:"density-select-label",name:"density",value:l,onChange:x=>i(x.target.value),children:[e.jsx(A,{value:"compact",children:"Compact"}),e.jsx(A,{value:"standard",children:"Standard"}),e.jsx(A,{value:"comfortable",children:"Comfortable"})]})]})]}),e.jsxs(m,{sx:{display:"flex",flexDirection:"column",gap:2,mt:3},children:[e.jsx(c,{variant:"h6",children:"Membership"}),p?e.jsxs(m,{sx:{p:2,border:"1px solid",borderColor:f?"error.main":"primary.main",borderRadius:1},children:[e.jsxs(m,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[f?e.jsx(ke,{color:"error"}):e.jsx(at,{color:"success"}),e.jsx(c,{variant:"subtitle1",fontWeight:"bold",color:f?"error":"inherit",children:f?"Expired Key":"Verified"})]}),e.jsxs(c,{variant:"body2",children:[e.jsx("b",{children:"Channel:"})," ",p.channel]}),e.jsxs(c,{variant:"body2",color:f?"error":"inherit",children:[e.jsx("b",{children:f?"Expired":"Expires"}),":"," ",sr(p.expiresAt)]}),e.jsx(D,{variant:"outlined",color:"error",startIcon:e.jsx(it,{}),onClick:y,sx:{mt:2},fullWidth:!0,children:"Delete Key"})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{label:"Membership Key",variant:"outlined",fullWidth:!0,type:"text",value:o,onChange:x=>b(x.target.value),onKeyDown:x=>{x.key==="Enter"&&S()},error:!!T,helperText:T}),e.jsx(D,{variant:"contained",onClick:S,disabled:j||!o.trim(),fullWidth:!0,children:j?e.jsx(pe,{size:24}):"Verify Key"})]})]})]}),e.jsx(le,{children:e.jsx(D,{onClick:I,children:"Close"})})]})};function ar({children:t}){const r=ce(),n=v(y=>y.sidebarOpen),l=v(y=>y.setSidebarOpen),[s,i]=d.useState(!1),[h,p]=d.useState(!1),[u,w]=d.useState(!1),o=z("(max-width:768px)"),b=o?180:200,j=60,g=[{name:"Search",icon:e.jsx(Ke,{}),value:"search"},{name:"Graph",icon:e.jsx(_e,{}),value:"graph"}],T=()=>{o?i(!s):l(!n)},a=()=>{S("/")},S=y=>{o&&i(!1),r(y)};return e.jsxs(m,{sx:{display:"flex"},children:[o&&!s&&e.jsx(m,{sx:{position:"fixed",top:10,left:10,zIndex:1200,backgroundColor:"background.paper",borderRadius:"50%",boxShadow:2},children:e.jsx(P,{onClick:()=>i(!0),sx:{borderRadius:"50%",p:1},children:e.jsx(Le,{})})}),e.jsx(ot,{open:o?s:!0,variant:o?"temporary":"persistent",onClose:o?()=>i(!1):void 0,sx:{width:o||n?b:j,flexShrink:0,"& .MuiDrawer-paper":{width:o||n?b:j,boxSizing:"border-box",overflowX:"hidden",transition:"width 0.3s ease-in-out"}},children:e.jsxs(m,{sx:{overflow:"hidden"},children:[e.jsxs(lt,{children:[e.jsx(R,{disablePadding:!0,children:e.jsxs(P,{onClick:T,sx:{justifyContent:"center"},children:[e.jsx(Z,{sx:{minWidth:0},children:e.jsx(Le,{})}),(!o&&n||o)&&e.jsx(O,{primary:""})]})}),e.jsx(R,{disablePadding:!0,children:e.jsx(V,{title:!o&&!n?"Home":"",placement:"right",children:e.jsxs(P,{onClick:a,sx:{paddingLeft:!o&&!n?2.4:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:e.jsx(ct,{})}),(!o&&n||o)&&e.jsx(O,{primary:"Home"})]})})}),!o&&!n&&e.jsx(R,{sx:{height:16}}),e.jsx(O,{primary:"Pages",sx:{mt:2,ml:1,display:!o&&n||o?"block":"none"}}),g.map(y=>e.jsx(R,{disablePadding:!0,children:e.jsx(V,{title:!o&&!n?y.name:"",placement:"right",children:e.jsxs(P,{selected:window.location.pathname.split("/")[3]===y.value,onClick:()=>S(y.value),sx:{paddingLeft:!o&&!n?2:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:y.icon}),(!o&&n||o)&&e.jsx(O,{primary:y.name})]})})},y.value)),e.jsx(R,{disablePadding:!0,sx:{mt:2},children:e.jsx(V,{title:"https://github.com/duckautomata/archived-transcript",placement:"right",children:e.jsxs(P,{onClick:()=>{window.open("https://github.com/duckautomata/archived-transcript","_blank","noopener noreferrer")},sx:{paddingLeft:!o&&!n?2:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:e.jsx(dt,{})}),(!o&&n||o)&&e.jsx(O,{primary:"GitHub"})]})})}),e.jsx(R,{disablePadding:!0,children:e.jsx(V,{title:!o&&!n?"Help":"",placement:"right",children:e.jsxs(P,{onClick:()=>p(!0),sx:{paddingLeft:!o&&!n?2:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:e.jsx(ht,{})}),(!o&&n||o)&&e.jsx(O,{primary:"Help"})]})})}),e.jsx(R,{disablePadding:!0,children:e.jsx(V,{title:!o&&!n?"Settings":"",placement:"right",children:e.jsxs(P,{onClick:()=>w(!0),sx:{paddingLeft:!o&&!n?2:void 0,overflow:"hidden"},children:[e.jsx(Z,{children:e.jsx(mt,{})}),(!o&&n||o)&&e.jsx(O,{primary:"Settings"})]})})})]}),e.jsx(nr,{open:u,setOpen:w}),e.jsx(qt,{open:h,setOpen:p})]})}),e.jsx(m,{component:"main",sx:{flexGrow:1,padding:1,width:o?"100%":`calc(97vw - ${n?b:j}px)`,transition:"width 0.3s ease-in-out, margin-left 0.3s ease-in-out"},children:t})]})}const ir=fe("span")(({theme:t})=>({color:t.palette.primary.main})),or=fe("span")(({theme:t})=>({"&":{color:t.palette.timestamp.main}})),lr=d.memo(function({text:r,start:n,targetWord:l,margin:s,onActionClick:i}){const h=Ue(),p=v(T=>T.density),u=new RegExp(`(${l})`,"gi"),w=r.split(u),o=h.palette.id.main,b=p==="comfortable"?"medium":"small",j=p==="compact"?{padding:0}:{},g=()=>{i(n,r)};return e.jsxs(m,{sx:{display:"flex",alignItems:"center",mt:s,textAlign:"left"},children:[e.jsx(V,{title:"Line Actions",children:e.jsx(Ce,{size:b,sx:j,onClick:g,children:e.jsx(Pe,{style:{color:o}})})})," ",e.jsxs(c,{component:"p",sx:{ml:1,wordBreak:"break-word"},children:["[",e.jsx(or,{theme:h,children:n}),"]"," ",e.jsx("span",{children:w.map((T,a)=>u.test(T)?e.jsx(ir,{children:e.jsx("u",{children:T})},a):e.jsx("span",{children:T},a))})]})]})}),cr=d.memo(function({stream:r,targetWord:n}){const l=ce(),s=z("(max-width:768px)"),{id:i,streamer:h,date:p,streamType:u,title:w,contexts:o}=r,b=o.length,j=b===Xt,[g,T]=d.useState(!1),[a,S]=d.useState(!1),[y,I]=d.useState({timestamp:"",lineText:"",internalJumpUrl:"",externalVideoUrl:""}),[f,x]=d.useState(!1),[E,M]=d.useState(""),_=v(F=>F.density);let N=.5;_==="standard"?N=1.5:_==="comfortable"&&(N=2.5);const he=()=>{l(`/transcript/${i}`)},q=()=>{l(`/graph/${i}`)},re=d.useCallback((F,ve)=>{let we,Ee;const Te=F.split(":");if(u==="Twitch"){const Se=`${Te[0]}h${Te[1]}m${Te[2]}s`;we=`https://www.twitch.tv/videos/${i}?t=${Se}`}else{const Se=Qe(F);we=`https://www.youtube.com/watch?v=${i}&t=${Se}s`}const tt=F.replace(/:/g,"-");Ee=`/transcript/${i}#T${tt}`,I({timestamp:F,lineText:ve,internalJumpUrl:Ee,externalVideoUrl:we}),S(!0)},[u,i]),H=()=>{S(!1),I({timestamp:"",lineText:"",internalJumpUrl:"",externalVideoUrl:""})},ge=()=>{let F;u==="Twitch"?F=`https://www.twitch.tv/videos/${i}`:F=`https://www.youtube.com/watch?v=${i}`,M(F),x(!0)},B=()=>{x(!1)},je=()=>{window.open(E,"_blank").focus(),x(!1)},ye=()=>{y.internalJumpUrl&&l(y.internalJumpUrl),H()},be=()=>{y.externalVideoUrl&&navigator.clipboard.writeText(y.externalVideoUrl),H()},W=()=>{y.externalVideoUrl&&window.open(y.externalVideoUrl,"_blank").focus(),H()};let k="#5e5e5eff",C=1;u==="Video"?(k="#0f2380ff",C=1):u==="Twitch"?(k="#6441a5",C=1):u==="TwitchVod"?(k="#FF41a5",C=1):u==="External"?(k="#af6c6cff",C=1):u==="Members"&&(k="#FFD700",C=2);const U={display:"block",cursor:"pointer",padding:"12px 16px"},$={padding:"16px",borderTop:C?`1px solid ${k}`:"none"},et=F=>{T(F.currentTarget.open)};return e.jsxs(m,{component:"details",onToggle:et,sx:{mb:N,borderRadius:4,border:C?`${C}px solid ${k}`:"none",overflow:"hidden"},children:[e.jsx("summary",{style:U,children:e.jsxs(m,{sx:{alignItems:"center",width:"100%",overflow:"hidden",display:"flex",flexWrap:s?"wrap":"nowrap"},children:[e.jsx(c,{variant:"body2",sx:{flexShrink:0,mr:2,color:"text.secondary"},children:Je(p)}),e.jsx(c,{variant:"body2",sx:{flexShrink:0,mr:2,color:"text.secondary"},children:h}),e.jsx(c,{variant:"body2",sx:{flexShrink:0,mr:2,color:k,fontWeight:"bold"},children:u}),e.jsx(c,{variant:"body2",sx:{flexGrow:1,mr:2,mt:s?1:0,width:s?"100%":"auto",order:s?1:0,noWrap:!0,textOverflow:"ellipsis"},children:w}),e.jsxs(c,{variant:"body2",sx:{width:"70px",flexShrink:0,mr:s?0:2,ml:s?"auto":0,color:"text.secondary",textAlign:"right"},children:[b," found"]})]})}),g&&e.jsxs("div",{style:$,children:[e.jsxs(xt,{direction:s?"column":"row",spacing:2,sx:{mb:2,justifyContent:"center"},children:[e.jsx(D,{variant:"contained",size:"small",onClick:he,startIcon:e.jsx(ut,{}),sx:{flexShrink:0},children:"View Full Transcript"}),e.jsx(D,{variant:"contained",size:"small",onClick:q,startIcon:e.jsx(pt,{}),sx:{flexShrink:0},children:"Graph This Stream"}),e.jsx(D,{variant:"outlined",size:"small",onClick:ge,startIcon:e.jsx(ft,{}),sx:{flexShrink:0},children:"Open This Stream"})]}),j&&e.jsx(c,{children:'Note: results may be limited. To see all results, click on "View Full Transcript"'}),u==="Members"&&e.jsx(c,{variant:"h6",color:"error",sx:{mb:2,mt:2,fontWeight:"bold",p:1,borderRadius:1},children:"This is members content and should only be used for personal use, never shared."}),o.map((F,ve)=>e.jsx(lr,{start:F.startTime,text:F.line,targetWord:n,margin:N,onActionClick:re},`${i}-${F.startTime}-${ve}`))]}),e.jsxs(ae,{open:a,onClose:H,"aria-labelledby":"line-action-dialog-title",children:[e.jsxs(ie,{id:"line-action-dialog-title",children:["Line Action [",y.timestamp,"]"]}),e.jsxs(oe,{children:[e.jsxs(ne,{sx:{mb:2,fontStyle:"italic",wordBreak:"break-word"},children:['"',y.lineText,'"']}),e.jsx(ne,{children:"Choose an action for this line:"})]}),e.jsxs(le,{sx:{display:"flex",flexDirection:"column",p:2,gap:2,"& > :not(style)":{marginLeft:"0 !important"}},children:[e.jsx(D,{onClick:ye,variant:"outlined",fullWidth:!0,children:"Jump to Line in Transcript"}),e.jsx(D,{onClick:be,variant:"outlined",fullWidth:!0,children:"Copy External Link"}),e.jsx(D,{onClick:W,variant:"contained",fullWidth:!0,autoFocus:!0,children:"Open External Link"}),e.jsx(D,{onClick:H,color:"inherit",fullWidth:!0,sx:{mt:1},children:"Cancel"})]})]}),e.jsxs(ae,{open:f,onClose:B,"aria-labelledby":"external-nav-dialog-title",children:[e.jsx(ie,{id:"external-nav-dialog-title",children:"Confirm External Navigation"}),e.jsxs(oe,{children:[e.jsx(ne,{children:"You are about to be redirected to an external site."}),e.jsxs(ne,{sx:{mt:2,wordBreak:"break-all"},children:["URL: ",E]})]}),e.jsxs(le,{children:[e.jsx(D,{onClick:B,children:"Cancel"}),e.jsx(D,{onClick:je,variant:"contained",color:"primary",autoFocus:!0,children:"Proceed to Site"})]})]})]})});function Fe({onSearch:t}){const r=v(i=>i.searchText),n=v(i=>i.setSearchText),l=d.useRef(null);d.useEffect(()=>{const i=h=>{(h.ctrlKey||h.metaKey)&&h.key==="f"?(h.preventDefault(),l.current&&(l.current.focus(),l.current.select())):h.key==="Escape"&&l.current&&document.activeElement===l.current&&l.current.blur()};return window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i)}},[]);const s=i=>{i.key==="Enter"&&t&&t()};return e.jsx(m,{sx:{mb:4,p:2},children:e.jsx(L,{container:!0,spacing:2,alignItems:"center",children:e.jsx(L,{size:12,children:e.jsx(G,{inputRef:l,fullWidth:!0,label:"Search Text",variant:"outlined",value:r,onChange:i=>n(i.target.value),onKeyDown:s})})})})}function Ze(){const t=v(a=>a.streamer),r=v(a=>a.streamType),n=v(a=>a.fromDate),l=v(a=>a.toDate),s=v(a=>a.streamTitle),i=v(a=>a.matchWholeWord),h=v(a=>a.setStreamer),p=v(a=>a.setStreamType),u=v(a=>a.setFromDate),w=v(a=>a.setToDate),o=v(a=>a.setStreamTitle),b=v(a=>a.setMatchWholeWord),j=["Dokibird","MintFantome"],g=["Video","Stream","Twitch","Members","TwitchVod","External"],T=a=>{const{target:{value:S}}=a;p(typeof S=="string"?S.split(","):S)};return e.jsxs(e.Fragment,{children:["Filter",e.jsx(m,{sx:{mb:4,p:2},children:e.jsxs(L,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(L,{size:{xs:12,sm:6,md:3},children:e.jsxs(me,{fullWidth:!0,sx:{minWidth:80},children:[e.jsx(xe,{id:"streamer-select-label",children:"Streamer"}),e.jsxs(ue,{labelId:"streamer-select-label",label:"Streamer",value:t,onChange:a=>h(a.target.value),children:[e.jsx(A,{value:"",children:"Any"}),j.map(a=>e.jsx(A,{value:a,children:a},a))]})]})}),e.jsx(L,{size:{xs:12,sm:6,md:3},children:e.jsxs(me,{fullWidth:!0,sx:{minWidth:120},children:[e.jsx(xe,{id:"type-select-label",children:"Type"}),e.jsx(ue,{labelId:"type-select-label",multiple:!0,value:r,onChange:T,input:e.jsx(yt,{label:"Type"}),renderValue:a=>e.jsx(m,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:a.map(S=>e.jsx(jt,{label:S,size:"small"},S))}),children:g.map(a=>e.jsxs(A,{value:a,children:[e.jsx(gt,{checked:r.includes(a)}),e.jsx(O,{primary:a})]},a))})]})}),e.jsx(L,{size:{xs:12,sm:6,md:3},children:e.jsx(G,{fullWidth:!0,label:"From",type:"date",value:n,onChange:a=>u(a.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(L,{size:{xs:12,sm:6,md:3},children:e.jsx(G,{fullWidth:!0,label:"To",type:"date",value:l,onChange:a=>w(a.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(L,{size:{xs:12,sm:8},children:e.jsx(G,{fullWidth:!0,label:"Stream Title",variant:"outlined",value:s,onChange:a=>o(a.target.value)})}),e.jsx(L,{size:{xs:12,sm:4},children:e.jsx(bt,{sx:{flexDirection:{xs:"column",sm:"row"},justifyContent:"center",gap:2},children:e.jsx(Re,{control:e.jsx(Ve,{checked:i,onChange:a=>b(a.target.checked)}),label:"Match Whole Word"})})})]})})]})}function dr(){const t=v(De(g=>({searchText:g.searchText,streamer:g.streamer,streamType:g.streamType,fromDate:g.fromDate,toDate:g.toDate,streamTitle:g.streamTitle,matchWholeWord:g.matchWholeWord}))),[r,n]=d.useState(!1),[l,s]=d.useState(!1),[i,h]=d.useState(null),[p,u]=d.useState([]),[w,o]=d.useState(t.searchText),b=p.length,j=d.useCallback(async()=>{s(!0),n(!0),h(null),u([]);try{const g=await Jt(t);g&&g.result&&(u(g.result),o(t.searchText))}catch(g){h(g.message||"Failed to search transcripts.")}finally{s(!1)}},[t]);return e.jsxs(Ie,{sx:{padding:0},children:[e.jsxs(m,{sx:{my:4},children:[e.jsx(c,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:"Search Transcripts"}),e.jsx(Fe,{onSearch:j}),e.jsx(Ze,{}),e.jsx(D,{variant:"outlined",onClick:j,disabled:l,fullWidth:!0,children:l?"Searching...":"Search"})]}),e.jsxs(m,{sx:{mt:4},children:[l&&e.jsx(m,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx(pe,{})}),i&&e.jsx(K,{severity:"error",sx:{my:2},children:i}),r&&!l&&!i&&b===0&&e.jsx(K,{severity:"info",sx:{my:2},children:"No data found for the selected criteria."}),b>0&&!l&&e.jsxs(m,{children:[e.jsxs(c,{variant:"body2",sx:{mb:2,textAlign:"center",color:"text.secondary"},children:["Found ",b," streams"]}),e.jsx(ze,{style:{height:"80vh",marginBottom:"40px"},data:p,itemContent:(g,T)=>e.jsx(cr,{stream:T,targetWord:w},T.id)})]})]})]})}function hr(){const[t,r]=d.useState([]),[n,l]=d.useState(!1),[s,i]=d.useState(null),[h,p]=d.useState(null),[u,w]=d.useState(!1),[o,b]=d.useState(!1),j=v(De(a=>({searchText:a.searchText,streamer:a.streamer,streamType:a.streamType,fromDate:a.fromDate,toDate:a.toDate,streamTitle:a.streamTitle,matchWholeWord:a.matchWholeWord}))),g=d.useCallback(async()=>{if(w(!0),r([]),p(null),!j.searchText||j.searchText.trim()===""){i("Search text cannot be empty. Please enter a search term.");return}l(!0),i(null);try{const a=await Zt(j);if(a&&a.result&&(r(a.result),a.result.length>0)){const S=a.result.reduce((I,f)=>I+f.y,0),y=Math.max(...a.result.map(I=>I.y));p({total:S,max:y})}}catch(a){i(a.message||"Failed to fetch graph data.")}finally{l(!1)}},[j]),T=d.useMemo(()=>{if(!o)return t.map(S=>{const[y,I,f]=S.x.split("-").map(Number);return{x:new Date(y,I-1,f),y:S.y}});let a=0;return t.map(S=>{const[y,I,f]=S.x.split("-").map(Number),x=new Date(y,I-1,f);return a+=S.y,{x,y:a}})},[t,o]);return e.jsx(Ie,{sx:{padding:0},children:e.jsxs(m,{sx:{my:4},children:[e.jsx(c,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:"Graph Transcripts"}),e.jsx(Fe,{onSearch:g}),e.jsx(Ze,{}),e.jsx(D,{variant:"outlined",fullWidth:!0,onClick:g,disabled:n,children:n?"Graphing...":"Graph"}),e.jsxs(m,{sx:{mt:4},children:[n&&e.jsx(m,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx(pe,{})}),s&&e.jsx(K,{severity:"error",sx:{my:2},children:s}),u&&!n&&!s&&t.length===0&&e.jsx(K,{severity:"info",sx:{my:2},children:"No data found for the selected criteria."}),t.length>0&&!n&&e.jsxs(m,{children:[e.jsx(Re,{control:e.jsx(Ve,{checked:o,onChange:a=>b(a.target.checked)}),label:"Show Cumulative Sum",sx:{mb:1,display:"block"}}),h&&e.jsxs(m,{sx:{mb:2},children:[e.jsx(c,{variant:"h6",component:"h6",gutterBottom:!0,children:"Graph Statistics"}),e.jsxs(c,{variant:"body1",children:[e.jsx("b",{children:"Total Hits:"})," ",h.total.toLocaleString()]}),!o&&e.jsxs(c,{variant:"body1",children:[e.jsx("b",{children:"Max Hits (in one day):"})," ",h.max.toLocaleString()]})]}),e.jsx(m,{sx:{height:500,width:"100%"},children:e.jsx(Ne,{dataset:T,series:[{dataKey:"y",label:o?"Cumulative Count":"Count",showMark:!1,curve:"linear"}],xAxis:[{scaleType:"time",dataKey:"x",label:"Date",valueFormatter:a=>a?a.toLocaleString(void 0,{dateStyle:"medium"}):""}],yAxis:[{label:o?"Cumulative Count":"Count",min:0}],tooltip:{trigger:"axis"},grid:{vertical:!1,horizontal:!0}})})]})]})]})})}function mr(){const t=z("(max-width:768px)"),r=Math.max(Math.ceil((window.innerHeight-200)/36),1),n=Array.from(new Array(r));return e.jsxs(m,{sx:{height:"95vh",overflow:"hidden"},children:[e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(se,{variant:"text",width:"90%",height:40,sx:{mb:1}}),e.jsx(c,{variant:"h5",color:"primary",sx:{mb:1},children:"Loading Transcript..."})]}),e.jsxs("div",{className:"transcript",children:[e.jsx(m,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center",mb:3},children:e.jsx(se,{variant:"rounded",width:t?"100%":"50%",height:30})}),n.map((l,s)=>{const i=Math.max(1-s/n.length,.15);return e.jsxs(m,{sx:{display:"flex",alignItems:"center",mb:1.5,opacity:i},children:[e.jsx(se,{variant:"circular",width:24,sx:{mr:1}}),e.jsx(se,{variant:"text",width:80,sx:{mr:1}}),e.jsx(se,{variant:"text",width:"100%"})]},s)})]})]})}const xr=fe("span")(({theme:t})=>({"&":{color:t.palette.timestamp.main}})),ur=fe("span")(({theme:t})=>({backgroundColor:t.palette.mode==="dark"?"rgba(255, 255, 0, 0.4)":"rgba(255, 255, 0, 0.8)",color:t.palette.mode==="dark"?"#fff":"#000",borderRadius:"2px",padding:"0 2px",textDecoration:"underline"})),pr=d.memo(function({id:r,start:n,text:l,searchTerm:s,handleClick:i}){const h=Ue(),p=v(j=>j.density),u=h.palette.id.main,w=p==="comfortable"?"medium":"small",o=p==="compact"?{padding:0}:{},b=d.useMemo(()=>{if(!s||!s.trim())return l;try{const j=new RegExp(`(${s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return l.split(j).map((T,a)=>j.test(T)?e.jsx(ur,{children:T},a):T)}catch{return l}},[l,s]);return e.jsx(m,{id:r,sx:{padding:"1px 0","&:hover":{backgroundColor:h.palette.action.hover}},children:e.jsxs(c,{color:"secondary","aria-live":"assertive",whiteSpace:"pre-wrap",align:"left",style:{wordBreak:"break-word"},children:[e.jsx(V,{title:"Open video at timestamp",children:e.jsx(Ce,{size:w,sx:{...o,verticalAlign:"middle"},onClick:()=>i(n),children:e.jsx(Pe,{style:{color:u}})})})," ","[",e.jsx(xr,{theme:h,children:n}),"] ",b]})})});function fr(){const{id:t}=qe(),r=ce(),n=vt(),l=d.useRef(null),s=z("(max-width:768px)"),i=d.useRef(null),[h,p]=d.useState(""),[u,w]=d.useState(""),[o,b]=d.useState(""),[j,g]=d.useState(""),[T,a]=d.useState([]),[S,y]=d.useState(!0),[I,f]=d.useState(null),[x,E]=d.useState(!1),[M,_]=d.useState(""),[N,he]=d.useState(""),[q,re]=d.useState(""),H=T.filter(W=>W.text.toLowerCase().includes(q.toLowerCase())),ge=d.useCallback(W=>{let k;const C=W.split(":");if(o==="Twitch"){const $=`${C[0]}h${C[1]}m${C[2]}s`;k=`https://www.twitch.tv/videos/${t}?t=${$}`}else{const $=+C[0]*3600+ +C[1]*60+ +C[2];k=`https://www.youtube.com/watch?v=${t}&t=${$}s`}const U=W.replace(/:/g,"-");he(`/transcript/${t}#T${U}`),_(k),E(!0)},[o,t]),B=()=>{E(!1),_(""),he("")},je=()=>{re(""),r(N),B()},ye=()=>{M&&navigator.clipboard.writeText(M),B()},be=()=>{M&&window.open(M,"_blank").focus(),B()};return d.useEffect(()=>{let W=!0;async function k(){y(!0),f(null),a([]);try{const C=await Yt(t);W&&(p(C.date),w(C.streamTitle),b(C.streamType),g(C.streamer),a(C.transcriptLines||[]))}catch(C){W&&f({message:C.message||"Failed to fetch transcript data.",status:C.status||null})}finally{W&&y(!1)}}return k(),()=>{W=!1}},[t]),d.useEffect(()=>{if(S||T.length===0||!l.current||!n.hash||!n.hash.startsWith("#T"))return;const k=n.hash.substring(2).replace(/-/g,":");if(!k)return;const C=T.findIndex($=>$.start===k),U=T[C]?.id;C===-1||!U||setTimeout(()=>{l.current&&(l.current.scrollToIndex({index:C,align:"start"}),setTimeout(()=>{const $=document.getElementById(U);$&&($.classList.add("highlight"),setTimeout(()=>{document.getElementById(U)&&$.classList.remove("highlight")},2e3))},150))},100)},[S,T,n.hash]),d.useEffect(()=>{const W=k=>{(k.ctrlKey||k.metaKey)&&k.key==="f"?(k.preventDefault(),i.current&&(i.current.focus(),i.current.select())):k.key==="Escape"&&i.current&&document.activeElement===i.current&&i.current.blur()};return window.addEventListener("keydown",W),()=>{window.removeEventListener("keydown",W)}},[]),e.jsxs(m,{sx:{width:"100%"},children:[S?e.jsx(mr,{}):e.jsx(e.Fragment,{children:I?e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",height:"50vh"},children:[I.status===404?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{color:"primary",sx:{fontSize:60,mb:2}}),e.jsx(c,{variant:"h5",component:"h2",sx:{mb:1},children:"404 Not Found"}),e.jsx(c,{color:"text.secondary",children:I.message})]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{color:"error",sx:{fontSize:60,mb:2}}),e.jsx(c,{variant:"h5",component:"h2",sx:{mb:1},children:"Error fetching transcripts"}),e.jsx(c,{color:"text.secondary",children:I.message})]}),e.jsx(D,{variant:"contained",onClick:()=>r("/"),sx:{mt:2},children:"Go Back Home"})]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:u}),o==="Members"&&e.jsx(He,{elevation:4,sx:{position:"sticky",top:0,zIndex:10,p:1.5,mb:2,border:"2px solid",borderColor:"error.main",borderRadius:2},children:e.jsxs(c,{variant:"h6",color:"error",sx:{fontWeight:"bold",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[e.jsx(ke,{})," This is members content and should only be used for personal use, never shared."]})}),e.jsxs(c,{sx:{mb:2},children:[Je(h)," - ",o," - ",j]}),e.jsxs(m,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center",mb:2},children:[e.jsx(G,{inputRef:i,label:"Search Transcript",variant:"outlined",size:"small",value:q,onChange:W=>re(W.target.value),slotProps:{input:{startAdornment:e.jsx(wt,{position:"start",children:e.jsx(Tt,{})})}},sx:{width:s?"100%":"50%"}}),q&&e.jsx(Ce,{onClick:()=>{re("")},"aria-label":"clear search",children:e.jsx(St,{})})]}),e.jsx("hr",{}),e.jsx(ze,{ref:l,useWindowScroll:!0,style:{height:o==="Members"?s?"calc(100svh - 120px)":"calc(100vh - 250px)":s?"calc(100svh - 120px)":"calc(100vh - 180px)"},data:H,itemContent:(W,k)=>e.jsx(pr,{id:k.id,start:k.start,text:k.text,searchTerm:q,handleClick:ge},k.id?`line-${k.id}`:`line-idx-${W}`)})]})}),e.jsxs(ae,{open:x,onClose:B,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ie,{id:"alert-dialog-title",children:"Confirm External Navigation"}),e.jsxs(oe,{children:[e.jsx(ne,{id:"alert-dialog-description",children:"You are about to open an external site in a new tab. Do you want to continue?"}),e.jsx(c,{variant:"body2",sx:{mt:2,wordBreak:"break-all",color:"text.secondary"},children:M})]}),e.jsxs(le,{children:[e.jsx(D,{onClick:B,children:"Cancel"}),e.jsx(D,{onClick:je,children:"Jump to line"}),e.jsx(D,{onClick:ye,children:"Copy Instead"}),e.jsx(D,{onClick:be,autoFocus:!0,children:"Continue"})]})]})]})}function gr(){const{id:t}=qe(),r=ce(),[n,l]=d.useState(null),[s,i]=d.useState(null),[h,p]=d.useState([]),[u,w]=d.useState(!1),[o,b]=d.useState(null),[j,g]=d.useState(null),[T,a]=d.useState(!1),S=v(De(f=>({searchText:f.searchText,streamer:f.streamer,streamType:f.streamType,from:f.fromDate,to:f.toDate,streamTitle:f.streamTitle,matchWholeWord:f.matchWholeWord})));d.useEffect(()=>{if(!t){i({message:"No transcript ID found in URL.",status:404});return}let f=!0;i(null);async function x(){try{const E=await er(t);f&&l(E)}catch(E){f&&i({message:E.message||"Failed to fetch stream metadata.",status:E.status||null})}}return x(),()=>{f=!1}},[t]);const y=d.useCallback(async()=>{if(a(!0),p([]),g(null),!t){b("No transcript ID found in URL.");return}if(S.searchText===""){b("Search text cannot be empty. Please enter a search term.");return}w(!0),b(null);try{const f=await Qt(t,S);if(f&&f.result){if(p(f.result),f.result.length>0){const x=f.result.reduce((M,_)=>M+_.y,0),E=Math.max(...f.result.map(M=>M.y));g({total:x,max:E})}}else p([])}catch(f){b(f.message||"Failed to fetch graph data.")}finally{w(!1)}},[t,S]),I=d.useMemo(()=>{if(!h.length)return[];let f=0;return h.map(x=>{const E=Qe(x.x);return f+=x.y,{x:E,y:f}})},[h]);return e.jsx(Ie,{sx:{padding:0},children:s?.status===404?e.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",height:"50vh"},children:[e.jsx(Xe,{color:"primary",sx:{fontSize:60,mb:2}}),e.jsx(c,{variant:"h5",component:"h2",sx:{mb:1},children:"404 Not Found"}),e.jsx(c,{color:"text.secondary",children:s.message}),e.jsx(D,{variant:"contained",onClick:()=>r("/"),sx:{mt:2},children:"Go Back Home"})]}):e.jsxs(m,{sx:{my:4},children:[e.jsx(c,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:n?`Graph: ${n.streamTitle}`:"Graph Transcript"}),n&&e.jsxs(m,{sx:{mb:2,typography:"body2",color:"text.secondary",pl:.5},children:[n.streamType==="Members"&&e.jsx(c,{variant:"subtitle1",color:"error",sx:{mb:2,fontWeight:"bold",border:"1px solid red",p:1,borderRadius:1},children:"This is members content and should only be used for personal use, never shared."}),e.jsxs(c,{variant:"body2",children:[e.jsx("b",{children:"Streamer:"})," ",n.streamer," "," - ",e.jsx("b",{children:"Date:"})," ",n.date," "," - ",e.jsx("b",{children:"Type:"})," ",n.streamType]})]}),s&&e.jsx(K,{severity:"error",sx:{my:2},children:s}),e.jsx(Fe,{}),e.jsx(D,{variant:"outlined",fullWidth:!0,onClick:y,disabled:u,children:u?"Graphing...":"Graph"}),e.jsxs(m,{sx:{mt:4},children:[u&&e.jsx(m,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx(pe,{})}),o&&e.jsx(K,{severity:"error",sx:{my:2},children:o}),T&&!u&&!o&&h.length===0&&e.jsx(K,{severity:"info",sx:{my:2},children:"No data found for the selected criteria."}),h.length>0&&!u&&e.jsxs(m,{children:[j&&e.jsxs(m,{sx:{mb:2},children:[e.jsx(c,{variant:"h6",component:"h6",gutterBottom:!0,children:"Graph Statistics"}),e.jsxs(c,{variant:"body1",children:[e.jsx("b",{children:"Total Hits:"})," ",j.total.toLocaleString()]})]}),e.jsx(m,{sx:{height:400,width:"100%"},children:e.jsx(Ne,{dataset:I,series:[{dataKey:"y",label:"Cumulative Count",showMark:!1,curve:"linear"}],xAxis:[{scaleType:"linear",dataKey:"x",label:"Time",valueFormatter:rr}],yAxis:[{label:"Cumulative Count",min:0}],tooltip:{trigger:"axis"},grid:{vertical:!1,horizontal:!0}})})]})]})]})})}const jr=(t=300*1e3)=>{const[r,n]=d.useState(!1),l=async()=>{try{const s=await fetch("/archived-transcript/version.json",{cache:"no-store"});if(!s.ok)return;const i=await s.json();i.buildTime>1768018791844&&(console.log("Update available!",i.buildTime,1768018791844),n(!0))}catch(s){console.error("Failed to check for updates:",s)}};return d.useEffect(()=>{l();const s=setInterval(l,t);return()=>clearInterval(s)},[t]),{updateAvailable:r}},yr=()=>{const{updateAvailable:t}=jr(),r=()=>{window.location.reload(!0)};return e.jsx(kt,{open:t,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{width:"90%",maxWidth:500,top:{xs:"12px !important",sm:"24px !important"},left:"50% !important",transform:"translateX(-50%) !important"},children:e.jsxs(K,{severity:"info",variant:"filled",icon:!1,sx:{alignItems:"center",width:"100%",backgroundColor:"#17786E",backdropFilter:"blur(8px)",color:"#FFFFFF",fontWeight:500,boxShadow:"0 4px 20px rgba(0,0,0,0.4)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.2)"},action:e.jsx(D,{variant:"contained",size:"small",startIcon:e.jsx(Dt,{}),onClick:r,sx:{backgroundColor:"#FFFFFF",color:"black",borderRadius:"8px",textTransform:"none",fontWeight:"bold",px:2,whiteSpace:"nowrap",boxShadow:"0 2px 10px rgba(0,0,0,0.3)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"0 4px 12px rgba(0,0,0,0.4)"}},children:"Update"}),children:[e.jsx(Ct,{children:"Update Available"}),"Refresh the page or click the update button to update the website."]})})};function br(){const t=v(l=>l.theme);let n=z("(prefers-color-scheme: dark)")?$e:Ae;return t==="light"?n=Ae:t==="dark"&&(n=$e),e.jsxs(It,{theme:n,children:[e.jsx(Wt,{}),e.jsx(yr,{}),window.maintenance?e.jsx(Me,{children:e.jsx(ee,{path:"*",element:e.jsx(At,{})})}):e.jsx(e.Fragment,{children:e.jsx(ar,{children:e.jsxs(Me,{children:[e.jsx(ee,{path:"*",element:e.jsx($t,{})}),e.jsx(ee,{path:"search/",element:e.jsx(dr,{})}),e.jsx(ee,{path:"graph/",element:e.jsx(hr,{})}),e.jsx(ee,{path:"graph/:id",element:e.jsx(gr,{})}),e.jsx(ee,{path:"transcript/:id",element:e.jsx(fr,{})})]})})})]})}Ft.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(Et,{basename:"archived-transcript",children:e.jsx(br,{})})}));
